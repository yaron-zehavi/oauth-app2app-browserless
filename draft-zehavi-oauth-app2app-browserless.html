<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 App2App Browser-less Flow</title>
<meta content="Yaron Zehavi" name="author">
<meta content="
       This document describes a protocol allowing a  Client App  to obtain an OAuth grant from an  Authorization Server's Native App  using the   pattern, providing  native  app navigation user-experience (no web browser used), despite both apps belonging to different trust domains. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="native-apps" name="keyword">
<meta content="oauth" name="keyword">
<meta content="app2app" name="keyword">
<meta content="browser-less" name="keyword">
<meta content="browserless" name="keyword">
<meta content="draft-zehavi-oauth-app2app-browserless-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-zehavi-oauth-app2app-browserless.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Native OAuth App2App</td>
<td class="right">October 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Zehavi</td>
<td class="center">Expires 4 May 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-zehavi-oauth-app2app-browserless-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-10-31" class="published">31 October 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-05-04">4 May 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Zehavi</div>
<div class="org">Raiffeisen Bank International</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 App2App Browser-less Flow</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a protocol allowing a <em>Client App</em> to obtain an OAuth grant from an <em>Authorization Server's Native App</em> using the <span>[<a href="#App2App" class="cite xref">App2App</a>]</span> pattern, providing <strong>native</strong> app navigation user-experience (no web browser used), despite both apps belonging to different trust domains.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://yaron-zehavi.github.io/oauth-app2app-browserless/draft-zehavi-oauth-app2app-browserless.html">https://yaron-zehavi.github.io/oauth-app2app-browserless/draft-zehavi-oauth-app2app-browserless.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-zehavi-oauth-app2app-browserless/">https://datatracker.ietf.org/doc/draft-zehavi-oauth-app2app-browserless/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Web Authorization Protocol Working Group mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/yaron-zehavi/oauth-app2app-browserless">https://github.com/yaron-zehavi/oauth-app2app-browserless</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 4 May 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol" class="internal xref">Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-flow-overview" class="internal xref">Flow Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-authorization-server-metada" class="internal xref">Authorization Server Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-native_authorization_endpoi" class="internal xref">native_authorization_endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-native-authorization-reques" class="internal xref">Native Authorization Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-native-authorization-respon" class="internal xref">Native Authorization Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-federating-response" class="internal xref">Federating response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="auto internal xref">3.5.2</a>.  <a href="#name-deep-link-response" class="internal xref">Deep Link Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="auto internal xref">3.5.3</a>.  <a href="#name-routing-response" class="internal xref">Routing Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a href="#section-3.5.4" class="auto internal xref">3.5.4</a>.  <a href="#name-error-response" class="internal xref">Error Response</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-user-interacting-authorizat" class="internal xref">User-Interacting Authorization Server's App</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-client-app-response-handlin" class="internal xref">Client App response handling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-flow-completion" class="internal xref">Flow completion</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-detecting-presence-of-nativ" class="internal xref">Detecting Presence of Native Apps claiming Urls</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-recovery-from-failed-native" class="internal xref">Recovery from failed native App2App flows</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-embedded-user-agents" class="internal xref">Embedded User Agents</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-open-redirection-by-authori" class="internal xref">Open redirection by Authorization Server's User-Interacting App</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-open-redirection-by-client-" class="internal xref">Open redirection by Client App</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-deep-link-hijacking" class="internal xref">Deep link hijacking</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-authorization-code-theft-an" class="internal xref">Authorization code theft and injection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-request-leakage-and-manipul" class="internal xref">Request leakage and manipulation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-detecting-presence-of-native" class="internal xref">Detecting Presence of Native Apps claiming Urls on iOS and Android</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-ios" class="internal xref">iOS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-android" class="internal xref">Android</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-background-and-relation-to-" class="internal xref">Background and relation to other standards</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-app2app-across-trust-domain" class="internal xref">App2App across trust domains requires a web browser</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-impact-of-using-a-web-brows" class="internal xref">Impact of using a web browser</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-relation-to" class="internal xref">Relation to OpenID.Native-SSO</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-relation-to-2" class="internal xref">Relation to OAuth.First-Party</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document describes a protocol enabling native app navigation of an <span>[<a href="#App2App" class="cite xref">App2App</a>]</span> OAuth grant across <em>different Trust Domains</em>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">When <em>Clients</em> and <em>Authorization Servers</em> are located on <em>different Trust Domains</em>, authorization requests traverse across domains using <strong>federation</strong>, involving <em>Authorization Servers</em> acting as clients of <em>Downstream Authorization Servers</em>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Such federation setups create trust networks, for example in Academia and in the business world across corporations.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">When <em>App2App</em> is performed in federation scenarios, a purely native user-experience is not achieved, because a web browser must act as user-agent, as federated <em>Authorization Server's</em> urls are not claimed by any native app.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Using web browsers in <em>App2App</em> flows degrades the user experience somewhat.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This document specifies:<a href="#section-1-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1-7">
        <dt id="section-1-7.1">
<strong>native_authorization_endpoint</strong>:</dt>
        <dd style="margin-left: 1.5em" id="section-1-7.2">
          <p id="section-1-7.2.1">A new Authorization Server endpoint and corresponding metadata property <span class="bcp14">REQUIRED</span> to support the browser-less App2App flow.<a href="#section-1-7.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-7.3">
<strong>native_callback_uri</strong>:</dt>
        <dd style="margin-left: 1.5em" id="section-1-7.4">
          <p id="section-1-7.4.1">A new native authorization request parameter, specifying the deep link of <em>Client App</em>.<a href="#section-1-7.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-7.5">
<strong>native_app2app_unsupported</strong>:</dt>
        <dd style="margin-left: 1.5em" id="section-1-7.6">
          <p id="section-1-7.6.1">A new error code value.<a href="#section-1-7.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-2.1">
        <h3 id="name-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-2.1-1">In addition to the terms defined in referenced specifications, this document uses
the following terms:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">
<strong>OAuth</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">In this document, "OAuth" refers to OAuth 2.0, <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> in the <strong>authorization code flow</strong>.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">
<strong>OAuth Broker</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">An Authorization Server federating to other trust domains by acting as an OAuth Client of  <em>Downstream Authorization Servers</em>.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5">
<strong>Client App</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.6">
            <p id="section-2.1-2.6.1">A Native app OAuth client of <em>Authorization Server</em>. In accordance with "OAuth 2.0 for Native Apps" <span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span>, client's redirect_uri is claimed by the app.<a href="#section-2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.7">
<strong>Downstream Authorization Server</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.8">
            <p id="section-2.1-2.8.1">An Authorization Server downstream of another <em>Authorization Server</em>. It may be an <em>OAuth Broker</em> or the <em>User-Interacting Authorization Server</em>.<a href="#section-2.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.9">
<strong>User-Interacting Authorization Server</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.10">
            <p id="section-2.1-2.10.1">An Authorization Server which interacts with end-user. The interaction may be interim navigation (e.g: user input is required to guide where to federate), or performs user authentication and request authorization.<a href="#section-2.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.11">
<strong>User-Interacting App</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.12">
            <p id="section-2.1-2.12.1">Native App of <em>User-Interacting Authorization Server</em>.<a href="#section-2.1-2.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.13">
<strong>Deep Link</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.14">
            <p id="section-2.1-2.14.1">A url claimed by a native application.<a href="#section-2.1-2.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="protocol">
<section id="section-3">
      <h2 id="name-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol" class="section-name selfRef">Protocol</a>
      </h2>
<div id="flow-overview">
<section id="section-3.1">
        <h3 id="name-flow-overview">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-flow-overview" class="section-name selfRef">Flow Overview</a>
        </h3>
<span id="name-browser-less-app2app-across"></span><div id="app2app-browserless-w-brokers">
<figure id="figure-1">
          <div id="section-3.1-1.1">
            <div class="alignLeft art-svg artwork" id="section-3.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="368" width="424" viewBox="0 0 424 368" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,336" fill="none" stroke="black"></path>
                <path d="M 24,48 L 24,96" fill="none" stroke="black"></path>
                <path d="M 24,240 L 24,320" fill="none" stroke="black"></path>
                <path d="M 40,104 L 40,232" fill="none" stroke="black"></path>
                <path d="M 64,96 L 64,232" fill="none" stroke="black"></path>
                <path d="M 88,104 L 88,176" fill="none" stroke="black"></path>
                <path d="M 104,104 L 104,144" fill="none" stroke="black"></path>
                <path d="M 120,96 L 120,128" fill="none" stroke="black"></path>
                <path d="M 136,48 L 136,96" fill="none" stroke="black"></path>
                <path d="M 160,240 L 160,320" fill="none" stroke="black"></path>
                <path d="M 248,96 L 248,192" fill="none" stroke="black"></path>
                <path d="M 248,240 L 248,320" fill="none" stroke="black"></path>
                <path d="M 264,192 L 264,208" fill="none" stroke="black"></path>
                <path d="M 376,96 L 376,192" fill="none" stroke="black"></path>
                <path d="M 376,240 L 376,320" fill="none" stroke="black"></path>
                <path d="M 392,112 L 392,208" fill="none" stroke="black"></path>
                <path d="M 416,32 L 416,336" fill="none" stroke="black"></path>
                <path d="M 8,32 L 416,32" fill="none" stroke="black"></path>
                <path d="M 24,48 L 136,48" fill="none" stroke="black"></path>
                <path d="M 24,96 L 136,96" fill="none" stroke="black"></path>
                <path d="M 248,96 L 376,96" fill="none" stroke="black"></path>
                <path d="M 376,112 L 392,112" fill="none" stroke="black"></path>
                <path d="M 120,128 L 240,128" fill="none" stroke="black"></path>
                <path d="M 104,144 L 248,144" fill="none" stroke="black"></path>
                <path d="M 88,176 L 240,176" fill="none" stroke="black"></path>
                <path d="M 248,192 L 376,192" fill="none" stroke="black"></path>
                <path d="M 264,208 L 392,208" fill="none" stroke="black"></path>
                <path d="M 24,240 L 160,240" fill="none" stroke="black"></path>
                <path d="M 248,240 L 376,240" fill="none" stroke="black"></path>
                <path d="M 168,272 L 240,272" fill="none" stroke="black"></path>
                <path d="M 24,320 L 160,320" fill="none" stroke="black"></path>
                <path d="M 248,320 L 376,320" fill="none" stroke="black"></path>
                <path d="M 8,336 L 416,336" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="248,272 236,266.4 236,277.6" fill="black" transform="rotate(0,240,272)"></polygon>
                <polygon class="arrowhead" points="248,176 236,170.4 236,181.6" fill="black" transform="rotate(0,240,176)"></polygon>
                <polygon class="arrowhead" points="248,128 236,122.4 236,133.6" fill="black" transform="rotate(0,240,128)"></polygon>
                <polygon class="arrowhead" points="176,272 164,266.4 164,277.6" fill="black" transform="rotate(180,168,272)"></polygon>
                <polygon class="arrowhead" points="112,104 100,98.4 100,109.6" fill="black" transform="rotate(270,104,104)"></polygon>
                <polygon class="arrowhead" points="96,104 84,98.4 84,109.6" fill="black" transform="rotate(270,88,104)"></polygon>
                <polygon class="arrowhead" points="72,232 60,226.4 60,237.6" fill="black" transform="rotate(90,64,232)"></polygon>
                <polygon class="arrowhead" points="48,104 36,98.4 36,109.6" fill="black" transform="rotate(270,40,104)"></polygon>
                <g class="text">
                  <text x="84" y="68">Client</text>
                  <text x="80" y="84">App</text>
                  <text x="192" y="116">(1,3,7)</text>
                  <text x="288" y="116">Initial</text>
                  <text x="336" y="116">and</text>
                  <text x="300" y="132">Downstream</text>
                  <text x="312" y="148">Authorization</text>
                  <text x="192" y="164">(2,8)</text>
                  <text x="288" y="164">Servers</text>
                  <text x="192" y="196">(9)</text>
                  <text x="24" y="212">(6)</text>
                  <text x="80" y="212">(4)</text>
                  <text x="312" y="260">User-</text>
                  <text x="96" y="276">User-</text>
                  <text x="316" y="276">Authenticating</text>
                  <text x="96" y="292">Interacting</text>
                  <text x="192" y="292">(5)</text>
                  <text x="312" y="292">Authorization</text>
                  <text x="96" y="308">App</text>
                  <text x="308" y="308">Server</text>
                  <text x="172" y="356">Mobile</text>
                  <text x="228" y="356">Device</text>
                </g>
              </svg><a href="#section-3.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-browser-less-app2app-across" class="selfRef">Browser-less App2App across trust domains</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">(1) <em>Client App</em> presents an authorization request to <em>Authorization Server's</em> <strong>native_authorization_endpoint</strong>, including a <strong>native_callback_uri</strong>.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">(2) <em>Authorization Server</em> returns either:<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.2.2.1">
                <p id="section-3.1-2.2.2.1.1">A <em>native authorization request url</em> for a <em>Downstream Authorization Server</em>.<a href="#section-3.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.2.2.2">
                <p id="section-3.1-2.2.2.2.1">A request for end-user input to guide request routing.<a href="#section-3.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.2.2.3">
                <p id="section-3.1-2.2.2.3.1">A <em>deep link</em> url to its <em>User-Interacting App</em>.<a href="#section-3.1-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">(3) <em>Client App</em>:<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.3.2.1">
                <p id="section-3.1-2.3.2.1.1">Calls <em>native authorization request urls</em> it obtains, so long as such responses are obtained, until a <em>deep link</em> url to <em>User-Interacting App</em> is obtained.<a href="#section-3.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.3.2.2">
                <p id="section-3.1-2.3.2.2.1">Prompts end-user, then provides their input to <em>Authorization Server</em> to guide request routing.<a href="#section-3.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.3.2.3">
                <p id="section-3.1-2.3.2.3.1">Handles <em>deep links</em>, by invoking the app claiming the url, if present on the device.<a href="#section-3.1-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">(4) <em>Client App</em> natively invokes <em>User-Interacting App</em> claiming a <em>deep link</em> it has obtained.<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.5">
            <p id="section-3.1-2.5.1">(5) <em>User-Interacting App</em> authenticates end-user and authorizes the request.<a href="#section-3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.6">
            <p id="section-3.1-2.6.1">(6) <em>User-Interacting App</em> returns to <em>Client App</em> by natively invoking <strong>native_callback_uri</strong> and provides the url-encoded <em>redirect_uri</em> with its response parameters.<a href="#section-3.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.7">
            <p id="section-3.1-2.7.1">(7) <em>Client App</em> invokes the <em>redirect_uri</em> it obtained.<a href="#section-3.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.8">
            <p id="section-3.1-2.8.1">(8) <em>Client App</em> calls any subsequent uris obtained until its own redirect_uri is obtained.<a href="#section-3.1-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.9">
            <p id="section-3.1-2.9.1">(9) <em>Client App</em> exchanges code for tokens and the flow is complete.<a href="#section-3.1-2.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="authorization-server-metadata">
<section id="section-3.2">
        <h3 id="name-authorization-server-metada">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authorization-server-metada" class="section-name selfRef">Authorization Server Metadata</a>
        </h3>
<p id="section-3.2-1">This document introduces the following parameter as authorization server metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>, indicating support of <em>Native App2App</em>:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-2">
          <dt id="section-3.2-2.1">
<strong>native_authorization_endpoint</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">URL of the authorization server's native authorization endpoint.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="native-authorization-endpoint">
<section id="section-3.3">
        <h3 id="name-native_authorization_endpoi">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-native_authorization_endpoi" class="section-name selfRef">native_authorization_endpoint</a>
        </h3>
<p id="section-3.3-1">This is an OAuth authorization endpoint, interoperable with other OAuth RFCs.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The following additional requirements apply to native_authorization_endpoint, in line with common REST APIs:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-3.1">
            <p id="section-3.3-3.1.1"><span class="bcp14">SHALL</span> return Content-Type header with the value "application/json", and a JSON http body.<a href="#section-3.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.2">
            <p id="section-3.3-3.2.1"><span class="bcp14">SHALL NOT</span> return HTTP 30x redirects.<a href="#section-3.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.3">
            <p id="section-3.3-3.3.1"><span class="bcp14">SHALL NOT</span> respond with bot-detection challenges such as CAPTCHAs.<a href="#section-3.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="native-authorization-request">
<section id="section-3.4">
        <h3 id="name-native-authorization-reques">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-native-authorization-reques" class="section-name selfRef">Native Authorization Request</a>
        </h3>
<p id="section-3.4-1">An OAuth authorization request, interoperable with other OAuth RFCs, which also includes the <em>native_callback_uri</em> parameter:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-2">
          <dt id="section-3.4-2.1">
<strong>native_callback_uri</strong>:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1"><span class="bcp14">REQUIRED</span>. <em>Client App's</em> redirect_uri, claimed as deep link. <em>native_callback_uri</em> shall be invoked by <em>User-Interacting App</em> to receive its response. When invoked, <em>native_callback_uri</em> accepts the following parameter:<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-2.2.2">
              <dt id="section-3.4-2.2.2.1">
<strong>redirect_uri</strong>:</dt>
              <dd style="margin-left: 1.5em" id="section-3.4-2.2.2.2">
                <p id="section-3.4-2.2.2.2.1"><span class="bcp14">REQUIRED</span>. url-encoded redirect_uri from <em>User-Interacting App</em> responding to its OAuth client, including its respective response parameters.<a href="#section-3.4-2.2.2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.4-3"><em>Authorization servers</em> processing a <em>native authorization request</em> <span class="bcp14">MUST</span> also:<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-4.1">
            <p id="section-3.4-4.1.1">Forward the <em>native_callback_uri</em> in their requests to <em>Downstream Authorization Servers</em>.<a href="#section-3.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-4.2">
            <p id="section-3.4-4.2.1">Ensure that the <em>Downstream Authorization Servers</em> it federates to, offers a <em>native_authorization_endpoint</em>, otherwise return an error response with error code <em>native_app2app_unsupported</em>.<a href="#section-3.4-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="native-authorization-response">
<section id="section-3.5">
        <h3 id="name-native-authorization-respon">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-native-authorization-respon" class="section-name selfRef">Native Authorization Response</a>
        </h3>
<p id="section-3.5-1">The authorization server responds with <em>application/json</em> and either 200 OK or 4xx/5xx.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div id="federating-response">
<section id="section-3.5.1">
          <h4 id="name-federating-response">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-federating-response" class="section-name selfRef">Federating response</a>
          </h4>
<p id="section-3.5.1-1">If the <em>Authorization Server</em> decides to federate to another party such as <em>Downstream Authorization Server</em> or an upstream OAuth client, it responds with 200 OK and the following JSON response body:<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5.1-2">
            <dt id="section-3.5.1-2.1">action:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.1-2.2">
              <p id="section-3.5.1-2.2.1"><span class="bcp14">REQUIRED</span>. A string with the value "call" to indicate that <em>url</em> is to be called with HTTP GET.<a href="#section-3.5.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.1-2.3">url:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.1-2.4">
              <p id="section-3.5.1-2.4.1"><span class="bcp14">REQUIRED</span>. A string holding a native authorization request for <em>Downstream Authorization Server</em>, or redirect_uri of an OAuth client with a response.<a href="#section-3.5.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.5.1-3">Example instruction: call <em>Downstream Authorization Server</em>:<a href="#section-3.5.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.1-4">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{
    "action": "call",
    "url": "https://next-as.com/authorization/native?client_id=s6BhdRkqt3&amp;request_uri=urn%3Aietf%3Aparams%3Aoauth%3Arequest_uri%3AR3p_hzwsR7outNQSKfoX"
}
</pre><a href="#section-3.5.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.5.1-5">Example instruction: call OAuth client with a response:<a href="#section-3.5.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.1-6">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{
    "action": "call",
    "url": "https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA&amp;state=xyz"
}
</pre><a href="#section-3.5.1-6" class="pilcrow">¶</a>
</div>
<p id="section-3.5.1-7"><em>Client App</em> <span class="bcp14">SHALL</span> add all DNS domains of <em>urls</em> it encounters during each flow to an Allowlist, used to validate urls in the response handling phase, after being invoked by the <em>User-Interacting Authorization Server' App</em>.<a href="#section-3.5.1-7" class="pilcrow">¶</a></p>
<p id="section-3.5.1-8">It then <span class="bcp14">MUST</span> make an HTTP GET request to the returned <em>url</em> and process the response as defined in this document.<a href="#section-3.5.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deep-link-response">
<section id="section-3.5.2">
          <h4 id="name-deep-link-response">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-deep-link-response" class="section-name selfRef">Deep Link Response</a>
          </h4>
<p id="section-3.5.2-1">If the <em>Authorization Server</em> wishes to authenticate the user and authorize the request, using its <em>User-Interacting App</em>, it responds with 200 OK and the following JSON response body:<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5.2-2">
            <dt id="section-3.5.2-2.1">action:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.2-2.2">
              <p id="section-3.5.2-2.2.1"><span class="bcp14">REQUIRED</span>. A string with the value "deep_link" to indicate that <em>url</em> is to be called with HTTP GET.<a href="#section-3.5.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.2-2.3">url:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.2-2.4">
              <p id="section-3.5.2-2.4.1"><span class="bcp14">REQUIRED</span>. A string holding the deep link url claimed by the <em>User-Interacting App</em>.<a href="#section-3.5.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.5.2-3">Example:<a href="#section-3.5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.2-4">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{
    "action": "deep_link",
    "url": "uri of native authorization request handled by *User-Interacting App*",
}
</pre><a href="#section-3.5.2-4" class="pilcrow">¶</a>
</div>
<p id="section-3.5.2-5"><em>Client App</em> <span class="bcp14">MUST</span> use OS mechanisms to invoke the deep link received in <em>url</em> and open the <em>User-Interacting Authorization Server's App</em>. If no app claiming the deep link is be found, <em>Client App</em> <span class="bcp14">MUST</span> terminate the flow and <span class="bcp14">MAY</span> attempt a non-native flow. See <a href="#fallback" class="auto internal xref">Section 4.2</a>.<a href="#section-3.5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="routing-response">
<section id="section-3.5.3">
          <h4 id="name-routing-response">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-routing-response" class="section-name selfRef">Routing Response</a>
          </h4>
<p id="section-3.5.3-1">If the <em>Authorization Server</em> requires user input to determine where to federate, it responds with 200 OK and the following JSON body:<a href="#section-3.5.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5.3-2">
            <dt id="section-3.5.3-2.1">id:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.3-2.2">
              <p id="section-3.5.3-2.2.1"><span class="bcp14">OPTIONAL</span>. A string holding an interaction identifier used by <em>Authorization Server</em> to link the response to the request.<a href="#section-3.5.3-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.3-2.3">action:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.3-2.4">
              <p id="section-3.5.3-2.4.1"><span class="bcp14">REQUIRED</span>. A string with the value "prompt" to indicate that the client app must prompt the user for input before proceeding.<a href="#section-3.5.3-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.3-2.5">logo:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.3-2.6">
              <p id="section-3.5.3-2.6.1"><span class="bcp14">OPTIONAL</span>. URL or base64-encoded logo of <em>Authorization Server</em>, for branding purposes.<a href="#section-3.5.3-2.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.3-2.7">userPrompt:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.3-2.8">
              <p id="section-3.5.3-2.8.1"><span class="bcp14">REQUIRED</span>. A JSON object containing the prompt definition. The following parameters <span class="bcp14">MAY</span> be used:<a href="#section-3.5.3-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.5.3-3.1">
              <p id="section-3.5.3-3.1.1">options: <span class="bcp14">OPTIONAL</span>. A JSON object that defines a dropdown/select input with various options to choose from. Each key is the parameter name to be sent in the response and each value defines the option:<a href="#section-3.5.3-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.3-3.1.2.1">
                  <p id="section-3.5.3-3.1.2.1.1">title: <span class="bcp14">OPTIONAL</span>. A string holding the input's title.<a href="#section-3.5.3-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.5.3-3.1.2.2">
                  <p id="section-3.5.3-3.1.2.2.1">description: <span class="bcp14">OPTIONAL</span>. A string holding the input's description.<a href="#section-3.5.3-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.5.3-3.1.2.3">
                  <p id="section-3.5.3-3.1.2.3.1">values: <span class="bcp14">REQUIRED</span>. A JSON object where each key is the selection value and each value holds display data for that value:<a href="#section-3.5.3-3.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.3-3.1.2.3.2.1">
                      <p id="section-3.5.3-3.1.2.3.2.1.1">name: <span class="bcp14">REQUIRED</span>. A string holding the display name of the selection value.<a href="#section-3.5.3-3.1.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-3.5.3-3.1.2.3.2.2">
                      <p id="section-3.5.3-3.1.2.3.2.2.1">logo: <span class="bcp14">OPTIONAL</span>. A string holding a URL or base64-encoded image for that selection value.<a href="#section-3.5.3-3.1.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li class="normal" id="section-3.5.3-3.2">
              <p id="section-3.5.3-3.2.1">inputs: <span class="bcp14">OPTIONAL</span>. A JSON object that defines an input field. Each key is the parameter name to be sent in the response and each value defines the input field:<a href="#section-3.5.3-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.3-3.2.2.1">
                  <p id="section-3.5.3-3.2.2.1.1">title: <span class="bcp14">OPTIONAL</span>. A string holding the input's title.<a href="#section-3.5.3-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.5.3-3.2.2.2">
                  <p id="section-3.5.3-3.2.2.2.1">hint: <span class="bcp14">OPTIONAL</span>. A string holding the input's hint that is displayed if the input is empty.<a href="#section-3.5.3-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.5.3-3.2.2.3">
                  <p id="section-3.5.3-3.2.2.3.1">description: <span class="bcp14">OPTIONAL</span>. A string holding the input's description.<a href="#section-3.5.3-3.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<span class="break"></span><dl class="dlParallel" id="section-3.5.3-4">
            <dt id="section-3.5.3-4.1">response:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.3-4.2">
              <p id="section-3.5.3-4.2.1"><span class="bcp14">REQUIRED</span>. A JSON object that holds the URL to which the user input <span class="bcp14">MUST</span> be sent. It only supports two keys, which are mutually exclusive:<a href="#section-3.5.3-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.5.3-5.1">
              <p id="section-3.5.3-5.1.1">get: The corresponding value is the URL to use for a GET request with user input appended as query parameters.<a href="#section-3.5.3-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.5.3-5.2">
              <p id="section-3.5.3-5.2.1">post: The corresponding value is the URL to use for a POST request with user input sent in the request body, as application/x-www-form-urlencoded.<a href="#section-3.5.3-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.5.3-6">Example of prompting end-user for 2 multiple-choice inputs:<a href="#section-3.5.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.3-7">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{
    "action": "prompt",
    "id": "request-identifier-1",
    "logo": "uri or base64-encoded logo of Authorization Server",
    "userPrompt": {
        "options": {
            "bank": {
                "title": "Bank",
                "description": "Choose your Bank",
                "values": {
                    "bankOfSomething": {
                        "name": "Bank of Something",
                        "logo": "uri or base64-encoded logo"
                    },
                    "firstBankOfCountry": {
                        "name": "First Bank of Country",
                        "logo": "uri or base64-encoded logo"
                    }
                }
            },
            "segment": {
                "title": "Customer Segment",
                "description": "Choose your Customer Segment",
                "values": {
                    "retail": "Retail",
                    "smb": "Small &amp; Medium Businesses",
                    "corporate": "Corporate",
                    "ic": "Institutional Clients"
                }
            }
        }
    },
    "response": {
        "post": "url to POST to using application/x-www-form-urlencoded"
    }
}
</pre><a href="#section-3.5.3-7" class="pilcrow">¶</a>
</div>
<p id="section-3.5.3-8">Example of prompting end-user for text input entry:<a href="#section-3.5.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.3-9">
<pre>
HTTP/1.1 200 OK
Content-Type: application/vnd.oauth.app2app.routing+json

{
    "action": "prompt",
    "id": "request-identifier-2",
    "logo": "uri or base64-encoded logo of Authorization Server",
    "userPrompt": {
        "inputs": {
            "email": {
                "hint": "Enter your email address",
                "title": "E-Mail",
                "description": "Lorem Ipsum"
            }
        }
    },
    "response": {
        "get": "url to use for a GET with query params"
    }
}
</pre><a href="#section-3.5.3-9" class="pilcrow">¶</a>
</div>
<p id="section-3.5.3-10"><em>Client App</em> <span class="bcp14">MUST</span> prompt the user according to the response received.
It then <span class="bcp14">MUST</span> send the user input to the response endpoint using the requested method including the interaction id, if provided.<a href="#section-3.5.3-10" class="pilcrow">¶</a></p>
<p id="section-3.5.3-11">Example of <em>Client App</em> response following end-user multiple-choice:<a href="#section-3.5.3-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.3-12">
<pre>
POST /native/routing HTTP/1.1
Host: example.as.com
Content-Type: application/x-www-form-urlencoded

id=request-identifier-1
&amp;bank=bankOfSomething
&amp;segment=retail
</pre><a href="#section-3.5.3-12" class="pilcrow">¶</a>
</div>
<p id="section-3.5.3-13">Example of <em>Client App</em> response following end-user input entry:<a href="#section-3.5.3-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.3-14">
<pre>
POST /native/routing HTTP/1.1
Host: example.as.com
Content-Type: application/x-www-form-urlencoded

id=request-identifier-2
&amp;email=end_user@example.as.com
</pre><a href="#section-3.5.3-14" class="pilcrow">¶</a>
</div>
<p id="section-3.5.3-15"><em>Authorization Server's</em> routing response endpoint <span class="bcp14">MUST</span> process the routing response and respond according to {#native-authorization-response}.<a href="#section-3.5.3-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="error-response">
<section id="section-3.5.4">
          <h4 id="name-error-response">
<a href="#section-3.5.4" class="section-number selfRef">3.5.4. </a><a href="#name-error-response" class="section-name selfRef">Error Response</a>
          </h4>
<p id="section-3.5.4-1">If <em>Authorization Server</em> encounters an error whose audience is its OAuth client, it returns 200 OK with the following JSON body:<a href="#section-3.5.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5.4-2">
            <dt id="section-3.5.4-2.1">action:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.4-2.2">
              <p id="section-3.5.4-2.2.1"><span class="bcp14">REQUIRED</span>. A string with the value "call" to indicate that <em>url</em> is to called with HTTP GET.<a href="#section-3.5.4-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.4-2.3">url:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.4-2.4">
              <p id="section-3.5.4-2.4.1"><span class="bcp14">REQUIRED</span>. A string holding the redirect_uri of the OAuth client, including the OAuth error.<a href="#section-3.5.4-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.5.4-3">Example:<a href="#section-3.5.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.4-4">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{
    "action": "call",
    "url": "https://previous-as.com/auth/redirect?error=...&amp;error_description=...&amp;iss=...&amp;state=..."
}
</pre><a href="#section-3.5.4-4" class="pilcrow">¶</a>
</div>
<p id="section-3.5.4-5"><em>Client App</em> <span class="bcp14">MUST</span> make an HTTP GET request to the returned <em>url</em> and process the response as defined in this document.<a href="#section-3.5.4-5" class="pilcrow">¶</a></p>
<p id="section-3.5.4-6">If <em>Authorization Server</em> encounters an error, that it cannot/or must not send to its OAuth client, it responds with 4xx/5xx and the following JSON body:<a href="#section-3.5.4-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5.4-7">
            <dt id="section-3.5.4-7.1">error:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.4-7.2">
              <p id="section-3.5.4-7.2.1"><span class="bcp14">REQUIRED</span>. The error code as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and other OAuth RFCs.<a href="#section-3.5.4-7.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.4-7.3">error_description:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.4-7.4">
              <p id="section-3.5.4-7.4.1"><span class="bcp14">OPTIONAL</span>. The error description as defined in <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-3.5.4-7.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.5.4-8">Example:<a href="#section-3.5.4-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.4-9">
<pre>
HTTP/1.1 500 OK
Content-Type: application/json

{
    "error": "native_app2app_unsupported",
}
</pre><a href="#section-3.5.4-9" class="pilcrow">¶</a>
</div>
<p id="section-3.5.4-10"><em>Client App</em> <span class="bcp14">SHOULD</span> display an appropriate error message to the user and terminate the flow.
In case of <em>native_app2app_unsupported</em>, <em>Client App</em> <span class="bcp14">MUST</span> terminate the flow and <span class="bcp14">MAY</span> retry with a non-native flow. See <a href="#fallback" class="auto internal xref">Section 4.2</a>.<a href="#section-3.5.4-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="user-interacting-authorization-servers-app">
<section id="section-3.6">
        <h3 id="name-user-interacting-authorizat">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-user-interacting-authorizat" class="section-name selfRef">User-Interacting Authorization Server's App</a>
        </h3>
<p id="section-3.6-1">The <em>User-Interacting Authorization Server's</em> app handles the native authorization request:<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-2.1">
            <p id="section-3.6-2.1.1">Validates the native authorization request.<a href="#section-3.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.6-2.2">
            <p id="section-3.6-2.2.1">Establishes trust in <em>native_callback_uri</em> and validates that an app claiming <em>native_callback_uri</em> is on the device. Otherwise terminates the flow.<a href="#section-3.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.6-2.3">
            <p id="section-3.6-2.3.1">Authenticates end-user and authorizes the request.<a href="#section-3.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.6-2.4">
            <p id="section-3.6-2.4.1"><span class="bcp14">MUST</span> use <em>native_callback_uri</em> to invoke <em>Client App</em>, providing it the redirect url and its response parameters as the url-encoded query parameter <strong>redirect_uri</strong>.<a href="#section-3.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="client-app-response-handling">
<section id="section-3.7">
        <h3 id="name-client-app-response-handlin">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-client-app-response-handlin" class="section-name selfRef">Client App response handling</a>
        </h3>
<p id="section-3.7-1"><em>Client App</em> is natively invoked by <em>User-Interacting Authorization Server App</em>:<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-2.1">
            <p id="section-3.7-2.1.1">If invoked with an <em>error</em> parameter, without parameters at all, it <span class="bcp14">MUST</span> terminate the flow.<a href="#section-3.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.7-2.2">
            <p id="section-3.7-2.2.1">It <span class="bcp14">MUST</span> ignore any unknown parameters.<a href="#section-3.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.7-2.3">
            <p id="section-3.7-2.3.1">If invoked with a url-encoded <strong>redirect_uri</strong> as parameter, <em>Client App</em> <span class="bcp14">MUST</span> validate <em>redirect_uri</em>, and any url subsequently obtained, using the Allowlist it previously generated, and <span class="bcp14">MUST</span> terminate the flow if any url is not found in the Allowlist.<a href="#section-3.7-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.7-3"><em>Client App</em> <span class="bcp14">SHALL</span> invoke <em>redirect_uri</em>, and any validated subsequent obtained urls, using HTTP GET.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<p id="section-3.7-4"><strong>Authorization Servers</strong> processing <em>Native App2App</em> <span class="bcp14">MUST</span> respond to their redirect_uri invocations:<a href="#section-3.7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-5.1">
            <p id="section-3.7-5.1.1">According to the REST API guidelines specified in <a href="#native-authorization-endpoint" class="auto internal xref">Section 3.3</a>.<a href="#section-3.7-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.7-5.2">
            <p id="section-3.7-5.2.1">Returning a JSON body instructing the next url to call.<a href="#section-3.7-5.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.7-6">Example:<a href="#section-3.7-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7-7">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json

{
    "action": "call",
    "url": "redirect_uri of an OAuth Client, including response parameters",
}
</pre><a href="#section-3.7-7" class="pilcrow">¶</a>
</div>
<p id="section-3.7-8"><em>Client App</em> <span class="bcp14">MUST</span> handle any other response (2xx with an unexpected Content-Type / 3xx / 4xx / 5xx) as a failure and terminate the flow.<a href="#section-3.7-8" class="pilcrow">¶</a></p>
<p id="section-3.7-9">Note - As <em>Authorization Servers</em> <span class="bcp14">MAY</span> use Cookies to bind security elements (state, PKCE <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>) to the user agent, flows <span class="bcp14">MAY</span> break if necessary cookies are missing from subsequent HTTP requests, <em>Client App</em> <span class="bcp14">MUST</span> support cookies:<a href="#section-3.7-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-10.1">
            <p id="section-3.7-10.1.1">Store Cookies it has obtained in any HTTP response.<a href="#section-3.7-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.7-10.2">
            <p id="section-3.7-10.2.1">Send Cookies in subsequent HTTP requests.<a href="#section-3.7-10.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="flow-completion">
<section id="section-3.8">
        <h3 id="name-flow-completion">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-flow-completion" class="section-name selfRef">Flow completion</a>
        </h3>
<p id="section-3.8-1">Once <em>Client App's</em> own redirect_uri is obtained, <em>Client App</em> processes the response:<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.8-2.1">
            <p id="section-3.8-2.1.1">Exchanges code for tokens.<a href="#section-3.8-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.8-2.2">
            <p id="section-3.8-2.2.1">Or handles errors obtained.<a href="#section-3.8-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.8-3">And the <em>Native App2App</em> flow is complete.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-4">
      <h2 id="name-implementation-consideratio">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<div id="detecting-presence-of-native-apps-claiming-urls">
<section id="section-4.1">
        <h3 id="name-detecting-presence-of-nativ">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-detecting-presence-of-nativ" class="section-name selfRef">Detecting Presence of Native Apps claiming Urls</a>
        </h3>
<p id="section-4.1-1">Native Apps on iOS and Android <span class="bcp14">MAY</span> use OS SDK's to detect if an app claims a url.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">See <a href="#Appendix-A" class="auto internal xref">Appendix A</a> for more details.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fallback">
<section id="section-4.2">
        <h3 id="name-recovery-from-failed-native">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-recovery-from-failed-native" class="section-name selfRef">Recovery from failed native App2App flows</a>
        </h3>
<span id="name-app2web-using-the-browser"></span><div id="app2web-w-brokers">
<figure id="figure-2">
          <div id="section-4.2-1.1">
            <div class="alignLeft art-svg artwork" id="section-4.2-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="400" width="768" viewBox="0 0 768 400" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,368" fill="none" stroke="black"></path>
                <path d="M 24,48 L 24,96" fill="none" stroke="black"></path>
                <path d="M 40,104 L 40,240" fill="none" stroke="black"></path>
                <path d="M 96,96 L 96,208" fill="none" stroke="black"></path>
                <path d="M 120,48 L 120,96" fill="none" stroke="black"></path>
                <path d="M 136,144 L 136,352" fill="none" stroke="black"></path>
                <path d="M 152,176 L 152,256" fill="none" stroke="black"></path>
                <path d="M 272,176 L 272,256" fill="none" stroke="black"></path>
                <path d="M 336,176 L 336,256" fill="none" stroke="black"></path>
                <path d="M 352,256 L 352,272" fill="none" stroke="black"></path>
                <path d="M 464,176 L 464,256" fill="none" stroke="black"></path>
                <path d="M 480,192 L 480,272" fill="none" stroke="black"></path>
                <path d="M 552,176 L 552,272" fill="none" stroke="black"></path>
                <path d="M 568,272 L 568,304" fill="none" stroke="black"></path>
                <path d="M 704,272 L 704,304" fill="none" stroke="black"></path>
                <path d="M 720,176 L 720,272" fill="none" stroke="black"></path>
                <path d="M 744,144 L 744,352" fill="none" stroke="black"></path>
                <path d="M 760,32 L 760,368" fill="none" stroke="black"></path>
                <path d="M 8,32 L 760,32" fill="none" stroke="black"></path>
                <path d="M 24,48 L 120,48" fill="none" stroke="black"></path>
                <path d="M 24,96 L 120,96" fill="none" stroke="black"></path>
                <path d="M 136,144 L 744,144" fill="none" stroke="black"></path>
                <path d="M 152,176 L 272,176" fill="none" stroke="black"></path>
                <path d="M 336,176 L 464,176" fill="none" stroke="black"></path>
                <path d="M 552,176 L 720,176" fill="none" stroke="black"></path>
                <path d="M 464,192 L 480,192" fill="none" stroke="black"></path>
                <path d="M 96,208 L 144,208" fill="none" stroke="black"></path>
                <path d="M 272,208 L 328,208" fill="none" stroke="black"></path>
                <path d="M 480,208 L 544,208" fill="none" stroke="black"></path>
                <path d="M 40,240 L 152,240" fill="none" stroke="black"></path>
                <path d="M 280,240 L 336,240" fill="none" stroke="black"></path>
                <path d="M 488,240 L 552,240" fill="none" stroke="black"></path>
                <path d="M 152,256 L 272,256" fill="none" stroke="black"></path>
                <path d="M 336,256 L 464,256" fill="none" stroke="black"></path>
                <path d="M 352,272 L 480,272" fill="none" stroke="black"></path>
                <path d="M 552,272 L 720,272" fill="none" stroke="black"></path>
                <path d="M 568,304 L 704,304" fill="none" stroke="black"></path>
                <path d="M 136,352 L 744,352" fill="none" stroke="black"></path>
                <path d="M 8,368 L 760,368" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="552,208 540,202.4 540,213.6" fill="black" transform="rotate(0,544,208)"></polygon>
                <polygon class="arrowhead" points="496,240 484,234.4 484,245.6" fill="black" transform="rotate(180,488,240)"></polygon>
                <polygon class="arrowhead" points="336,208 324,202.4 324,213.6" fill="black" transform="rotate(0,328,208)"></polygon>
                <polygon class="arrowhead" points="288,240 276,234.4 276,245.6" fill="black" transform="rotate(180,280,240)"></polygon>
                <polygon class="arrowhead" points="152,208 140,202.4 140,213.6" fill="black" transform="rotate(0,144,208)"></polygon>
                <polygon class="arrowhead" points="48,104 36,98.4 36,109.6" fill="black" transform="rotate(270,40,104)"></polygon>
                <g class="text">
                  <text x="68" y="68">Client</text>
                  <text x="64" y="84">App</text>
                  <text x="116" y="116">1.</text>
                  <text x="156" y="116">Launch</text>
                  <text x="240" y="116">Authorization</text>
                  <text x="160" y="132">Request</text>
                  <text x="204" y="132">on</text>
                  <text x="248" y="132">Browser</text>
                  <text x="396" y="132">Mobile</text>
                  <text x="456" y="132">Browser</text>
                  <text x="308" y="164">2.Federate</text>
                  <text x="304" y="180">Auth.</text>
                  <text x="520" y="180">Auth.</text>
                  <text x="216" y="196">Initial</text>
                  <text x="300" y="196">Req.</text>
                  <text x="404" y="196">Downstream</text>
                  <text x="516" y="196">Req.</text>
                  <text x="632" y="196">User-</text>
                  <text x="216" y="212">Authorization</text>
                  <text x="408" y="212">Authorization</text>
                  <text x="636" y="212">Authenticating</text>
                  <text x="212" y="228">Server</text>
                  <text x="400" y="228">Servers</text>
                  <text x="632" y="228">Authorization</text>
                  <text x="628" y="244">Server</text>
                  <text x="72" y="260">5.Authorization</text>
                  <text x="304" y="260">Auth.</text>
                  <text x="512" y="260">4.Auth.</text>
                  <text x="76" y="276">Response</text>
                  <text x="300" y="276">Response</text>
                  <text x="516" y="276">Response</text>
                  <text x="56" y="292">(Deep</text>
                  <text x="104" y="292">Link)</text>
                  <text x="624" y="292">Web</text>
                  <text x="652" y="292">UI</text>
                  <text x="572" y="324">3.</text>
                  <text x="636" y="324">Authenticate</text>
                  <text x="560" y="340">&amp;</text>
                  <text x="608" y="340">Authorize</text>
                  <text x="684" y="340">end-user</text>
                  <text x="316" y="388">Mobile</text>
                  <text x="372" y="388">Device</text>
                </g>
              </svg><a href="#section-4.2-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-app2web-using-the-browser" class="selfRef">App2Web using the browser</a>
          </figcaption></figure>
</div>
<p id="section-4.2-2">The <em>Native App2App flow</em> described in this document <span class="bcp14">MAY</span> fail when:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-3.1">
            <p id="section-4.2-3.1.1">An error response is obtained.<a href="#section-4.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-3.2">
            <p id="section-4.2-3.2.1">Required <em>User-Interacting App</em> is not installed on end-user's device.<a href="#section-4.2-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-4"><em>Client App</em> <span class="bcp14">MAY</span> recover by launching a new, non-native authorization request on a web browser, in accordance with "OAuth 2.0 for Native Apps" <span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">Note - Failure because <em>User-Interacting App</em> is not installed on end-user's device, might succeed in future, if the missing app has been installed. <em>Client App</em> <span class="bcp14">MAY</span> choose if and when to retry the <em>Native App2App flow</em> after such a failure.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="embedded-user-agents">
<section id="section-5.1">
        <h3 id="name-embedded-user-agents">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-embedded-user-agents" class="section-name selfRef">Embedded User Agents</a>
        </h3>
<p id="section-5.1-1"><span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span> Security Considerations advises against using <em>embedded user agents</em>. The main concern is preventing theft through keystroke recording of end-user's credentials such as usernames and passwords.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Tasking the <em>Client App</em> to ask for user input for a <em>Downstream Authorization Server</em> <span class="bcp14">MUST NOT</span> be used to request user to provide sensitive information such as authentication credentials. <em>Client App</em> <span class="bcp14">SHOULD</span> terminate the flow if such a request is detected.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="open-redirection-by-authorization-servers-user-interacting-app">
<section id="section-5.2">
        <h3 id="name-open-redirection-by-authori">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-open-redirection-by-authori" class="section-name selfRef">Open redirection by Authorization Server's User-Interacting App</a>
        </h3>
<p id="section-5.2-1">To mitigate open redirection attacks, trust establishment in <em>native_callback_uri</em> is <span class="bcp14">RECOMMENDED</span> by <em>User-Interacting App</em>.
Any federating <em>Authorization Server</em> <span class="bcp14">MAY</span> also wish to establish trust.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The specific trust establishment mechanisms are outside the scope of this document.
For example purposes only, one possible way to establish trust is <span>[<a href="#OpenID.Federation" class="cite xref">OpenID.Federation</a>]</span>:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-3.1">
            <p id="section-5.2-3.1.1">Strip url path from <strong>native_callback_uri</strong> (retaining the DNS domain).<a href="#section-5.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-3.2">
            <p id="section-5.2-3.2.1">Add the url path /.well-known/openid-federation and perform trust chain resolution.<a href="#section-5.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-3.3">
            <p id="section-5.2-3.3.1">Inspect Client's metadata for redirect_uri's and validate <strong>native_callback_uri</strong> is included.<a href="#section-5.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="open-redirection-by-client-app">
<section id="section-5.3">
        <h3 id="name-open-redirection-by-client-">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-open-redirection-by-client-" class="section-name selfRef">Open redirection by Client App</a>
        </h3>
<p id="section-5.3-1">Client App <span class="bcp14">SHALL</span> construct an Allowlist of DNS domains it traverses while processing the request, used to enforce all urls it later traverses during response processing.
This mitigates open redirection attacks as urls not in this Allowlist <span class="bcp14">SHALL</span> be rejected.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">In addition <em>Client App</em> <span class="bcp14">MUST</span> ignore any invocation for response processing which is not in the context of a request it initiated.
It is <span class="bcp14">RECOMMENDED</span> the Allowlist be managed as a single-use object, destructed after each protocol flow ends.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">It is <span class="bcp14">RECOMMENDED</span> <em>Client App</em> allows only one OAuth request processing at a time.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deep-link-hijacking">
<section id="section-5.4">
        <h3 id="name-deep-link-hijacking">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-deep-link-hijacking" class="section-name selfRef">Deep link hijacking</a>
        </h3>
<p id="section-5.4-1">It is <span class="bcp14">RECOMMENDED</span> that all apps in this specification shall use https-scheme deep links (Android App Links / iOS universal links). Apps <span class="bcp14">SHOULD</span> implement the most specific package identifiers mitigating deep link hijacking by malicious apps.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-code-theft-and-injection">
<section id="section-5.5">
        <h3 id="name-authorization-code-theft-an">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-authorization-code-theft-an" class="section-name selfRef">Authorization code theft and injection</a>
        </h3>
<p id="section-5.5-1">Usage of PKCE <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span> is <span class="bcp14">REQUIRED</span> to mitigate authorization code theft and injection attacks.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-leakage-and-manipulation">
<section id="section-5.6">
        <h3 id="name-request-leakage-and-manipul">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-request-leakage-and-manipul" class="section-name selfRef">Request leakage and manipulation</a>
        </h3>
<p id="section-5.6-1">Usage of JAR <span>[<a href="#RFC9101" class="cite xref">RFC9101</a>]</span> is <span class="bcp14">RECOMMENDED</span> to mitigate request manipulation by <em>Client App</em>.
Usage of PAR <span>[<a href="#RFC9126" class="cite xref">RFC9126</a>]</span> IS <span class="bcp14">RECOMMENDED</span> to mitigate request content leakage, as well as request manipulation which it also mitigates.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document has no IANA actions.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="OpenID.Federation">[OpenID.Federation]</dt>
        <dd>
<span class="refAuthor">Hedberg, Ed, R.</span>, <span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">Solberg, A. A.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">De Marco, G.</span>, and <span class="refAuthor">V. Dzhuvinov</span>, <span class="refTitle">"OpenID Federation 1.0"</span>, <time datetime="2025-03" class="refDate">March 2025</time>, <span>&lt;<a href="https://openid.net/specs/openid-federation-1_0.html">https://openid.net/specs/openid-federation-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
        <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7636">https://www.rfc-editor.org/rfc/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8252">[RFC8252]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span> and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 for Native Apps"</span>, <span class="seriesInfo">BCP 212</span>, <span class="seriesInfo">RFC 8252</span>, <span class="seriesInfo">DOI 10.17487/RFC8252</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8252">https://www.rfc-editor.org/rfc/rfc8252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9101">[RFC9101]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: JWT-Secured Authorization Request (JAR)"</span>, <span class="seriesInfo">RFC 9101</span>, <span class="seriesInfo">DOI 10.17487/RFC9101</span>, <time datetime="2021-08" class="refDate">August 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9101">https://www.rfc-editor.org/rfc/rfc9101</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9126">[RFC9126]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span class="seriesInfo">RFC 9126</span>, <span class="seriesInfo">DOI 10.17487/RFC9126</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9126">https://www.rfc-editor.org/rfc/rfc9126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9396">[RFC9396]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Richer, J.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <span class="seriesInfo">RFC 9396</span>, <span class="seriesInfo">DOI 10.17487/RFC9396</span>, <time datetime="2023-05" class="refDate">May 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9396">https://www.rfc-editor.org/rfc/rfc9396</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="android.method.intent">[android.method.intent]</dt>
        <dd>
<span class="refTitle">"Android Intent Method"</span>, <span>n.d.</span>, <span>&lt;<a href="https://developer.android.com/reference/android/content/Intent">https://developer.android.com/reference/android/content/Intent</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="App2App">[App2App]</dt>
        <dd>
<span class="refAuthor">Heenan, J.</span>, <span class="refTitle">"Guest Blog: Implementing App-to-App Authorisation in OAuth2/OpenID Connect"</span>, <time datetime="2019-10" class="refDate">October 2019</time>, <span>&lt;<a href="https://openid.net/guest-blog-implementing-app-to-app-authorisation-in-oauth2-openid-connect/">https://openid.net/guest-blog-implementing-app-to-app-authorisation-in-oauth2-openid-connect/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="iOS.method.openUrl">[iOS.method.openUrl]</dt>
        <dd>
<span class="refTitle">"iOS open(_:options:completionHandler:) Method"</span>, <span>n.d.</span>, <span>&lt;<a href="https://developer.apple.com/documentation/uikit/uiapplication/open(_:options:completionhandler:)">https://developer.apple.com/documentation/uikit/uiapplication/open(_:options:completionhandler:)</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="iOS.option.universalLinksOnly">[iOS.option.universalLinksOnly]</dt>
        <dd>
<span class="refTitle">"iOS method property universalLinksOnly"</span>, <span>n.d.</span>, <span>&lt;<a href="https://developer.apple.com/documentation/uikit/uiapplication/openexternalurloptionskey/universallinksonly">https://developer.apple.com/documentation/uikit/uiapplication/openexternalurloptionskey/universallinksonly</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OAuth.First-Party">[OAuth.First-Party]</dt>
        <dd>
<span class="refAuthor">Parecki, A.</span>, <span class="refAuthor">Fletcher, G.</span>, and <span class="refAuthor">P. Kasselman</span>, <span class="refTitle">"OAuth 2.0 for First-Party Applications"</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-first-party-apps-01.html">https://www.ietf.org/archive/id/draft-ietf-oauth-first-party-apps-01.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Native-SSO">[OpenID.Native-SSO]</dt>
      <dd>
<span class="refAuthor">Fletcher, G.</span>, <span class="refTitle">"OpenID Connect Native SSO for Mobile Apps"</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-native-sso-1_0.html">https://openid.net/specs/openid-connect-native-sso-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="Appendix-A">
<section id="appendix-A">
      <h2 id="name-detecting-presence-of-native">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-detecting-presence-of-native" class="section-name selfRef">Detecting Presence of Native Apps claiming Urls on iOS and Android</a>
      </h2>
<div id="ios">
<section id="appendix-A.1">
        <h3 id="name-ios">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-ios" class="section-name selfRef">iOS</a>
        </h3>
<p id="appendix-A.1-1">App <span class="bcp14">SHALL</span> invoke iOS <span>[<a href="#iOS.method.openUrl" class="cite xref">iOS.method.openUrl</a>]</span> method with options <span>[<a href="#iOS.option.universalLinksOnly" class="cite xref">iOS.option.universalLinksOnly</a>]</span> which ensures URLs must be universal links and have an app configured to open them.
Otherwise the method returns false in completion.success.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="android">
<section id="appendix-A.2">
        <h3 id="name-android">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-android" class="section-name selfRef">Android</a>
        </h3>
<p id="appendix-A.2-1">App <span class="bcp14">SHALL</span> invoke Android <span>[<a href="#android.method.intent" class="cite xref">android.method.intent</a>]</span> method with FLAG_ACTIVITY_REQUIRE_NON_BROWSER, which throws ActivityNotFoundException if no matching app is found.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="background-and-relation-to-other-standards">
<section id="appendix-B">
      <h2 id="name-background-and-relation-to-">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-background-and-relation-to-" class="section-name selfRef">Background and relation to other standards</a>
      </h2>
<div id="app2app-across-trust-domains-requires-a-web-browser">
<section id="appendix-B.1">
        <h3 id="name-app2app-across-trust-domain">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-app2app-across-trust-domain" class="section-name selfRef">App2App across trust domains requires a web browser</a>
        </h3>
<span id="name-app2app-across-trust-domains"></span><div id="app2app-w-brokers-and-browser">
<figure id="figure-3">
          <div id="appendix-B.1-1.1">
            <div class="alignLeft art-svg artwork" id="appendix-B.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="464" width="768" viewBox="0 0 768 464" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,432" fill="none" stroke="black"></path>
                <path d="M 24,48 L 24,96" fill="none" stroke="black"></path>
                <path d="M 24,336 L 24,400" fill="none" stroke="black"></path>
                <path d="M 40,104 L 40,240" fill="none" stroke="black"></path>
                <path d="M 96,96 L 96,208" fill="none" stroke="black"></path>
                <path d="M 120,48 L 120,96" fill="none" stroke="black"></path>
                <path d="M 136,144 L 136,304" fill="none" stroke="black"></path>
                <path d="M 144,336 L 144,400" fill="none" stroke="black"></path>
                <path d="M 152,176 L 152,256" fill="none" stroke="black"></path>
                <path d="M 272,176 L 272,256" fill="none" stroke="black"></path>
                <path d="M 336,176 L 336,256" fill="none" stroke="black"></path>
                <path d="M 352,256 L 352,272" fill="none" stroke="black"></path>
                <path d="M 464,176 L 464,256" fill="none" stroke="black"></path>
                <path d="M 480,192 L 480,272" fill="none" stroke="black"></path>
                <path d="M 552,176 L 552,272" fill="none" stroke="black"></path>
                <path d="M 600,272 L 600,352" fill="none" stroke="black"></path>
                <path d="M 656,280 L 656,384" fill="none" stroke="black"></path>
                <path d="M 720,176 L 720,272" fill="none" stroke="black"></path>
                <path d="M 744,144 L 744,304" fill="none" stroke="black"></path>
                <path d="M 760,32 L 760,432" fill="none" stroke="black"></path>
                <path d="M 8,32 L 760,32" fill="none" stroke="black"></path>
                <path d="M 24,48 L 120,48" fill="none" stroke="black"></path>
                <path d="M 24,96 L 120,96" fill="none" stroke="black"></path>
                <path d="M 136,144 L 744,144" fill="none" stroke="black"></path>
                <path d="M 152,176 L 272,176" fill="none" stroke="black"></path>
                <path d="M 336,176 L 464,176" fill="none" stroke="black"></path>
                <path d="M 552,176 L 720,176" fill="none" stroke="black"></path>
                <path d="M 464,192 L 480,192" fill="none" stroke="black"></path>
                <path d="M 96,208 L 144,208" fill="none" stroke="black"></path>
                <path d="M 272,208 L 328,208" fill="none" stroke="black"></path>
                <path d="M 480,208 L 544,208" fill="none" stroke="black"></path>
                <path d="M 40,240 L 152,240" fill="none" stroke="black"></path>
                <path d="M 280,240 L 336,240" fill="none" stroke="black"></path>
                <path d="M 488,240 L 552,240" fill="none" stroke="black"></path>
                <path d="M 152,256 L 272,256" fill="none" stroke="black"></path>
                <path d="M 336,256 L 464,256" fill="none" stroke="black"></path>
                <path d="M 352,272 L 480,272" fill="none" stroke="black"></path>
                <path d="M 552,272 L 720,272" fill="none" stroke="black"></path>
                <path d="M 136,304 L 744,304" fill="none" stroke="black"></path>
                <path d="M 24,336 L 144,336" fill="none" stroke="black"></path>
                <path d="M 152,352 L 600,352" fill="none" stroke="black"></path>
                <path d="M 144,384 L 656,384" fill="none" stroke="black"></path>
                <path d="M 24,400 L 144,400" fill="none" stroke="black"></path>
                <path d="M 8,432 L 760,432" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="664,280 652,274.4 652,285.6" fill="black" transform="rotate(270,656,280)"></polygon>
                <polygon class="arrowhead" points="552,208 540,202.4 540,213.6" fill="black" transform="rotate(0,544,208)"></polygon>
                <polygon class="arrowhead" points="496,240 484,234.4 484,245.6" fill="black" transform="rotate(180,488,240)"></polygon>
                <polygon class="arrowhead" points="336,208 324,202.4 324,213.6" fill="black" transform="rotate(0,328,208)"></polygon>
                <polygon class="arrowhead" points="288,240 276,234.4 276,245.6" fill="black" transform="rotate(180,280,240)"></polygon>
                <polygon class="arrowhead" points="160,352 148,346.4 148,357.6" fill="black" transform="rotate(180,152,352)"></polygon>
                <polygon class="arrowhead" points="152,208 140,202.4 140,213.6" fill="black" transform="rotate(0,144,208)"></polygon>
                <polygon class="arrowhead" points="48,104 36,98.4 36,109.6" fill="black" transform="rotate(270,40,104)"></polygon>
                <g class="text">
                  <text x="76" y="68">Client</text>
                  <text x="72" y="84">App</text>
                  <text x="116" y="116">1.</text>
                  <text x="156" y="116">Launch</text>
                  <text x="240" y="116">Authorization</text>
                  <text x="160" y="132">Request</text>
                  <text x="204" y="132">on</text>
                  <text x="248" y="132">Browser</text>
                  <text x="396" y="132">Mobile</text>
                  <text x="456" y="132">Browser</text>
                  <text x="308" y="164">2.Federate</text>
                  <text x="304" y="180">Auth.</text>
                  <text x="520" y="180">Auth.</text>
                  <text x="216" y="196">Initial</text>
                  <text x="300" y="196">Req.</text>
                  <text x="404" y="196">Downstream</text>
                  <text x="516" y="196">Req.</text>
                  <text x="632" y="196">User-</text>
                  <text x="216" y="212">Authorization</text>
                  <text x="408" y="212">Authorization</text>
                  <text x="636" y="212">Authenticating</text>
                  <text x="212" y="228">Server</text>
                  <text x="400" y="228">Servers</text>
                  <text x="632" y="228">Authorization</text>
                  <text x="628" y="244">Server</text>
                  <text x="72" y="260">6.Authorization</text>
                  <text x="304" y="260">Auth.</text>
                  <text x="512" y="260">5.Auth.</text>
                  <text x="68" y="276">Response</text>
                  <text x="300" y="276">Response</text>
                  <text x="516" y="276">Response</text>
                  <text x="48" y="292">(Deep</text>
                  <text x="96" y="292">Link)</text>
                  <text x="188" y="340">3.</text>
                  <text x="252" y="340">Authenticate</text>
                  <text x="312" y="340">&amp;</text>
                  <text x="360" y="340">Authorize</text>
                  <text x="436" y="340">end-user</text>
                  <text x="496" y="340">(Deep</text>
                  <text x="544" y="340">Link)</text>
                  <text x="80" y="356">User-</text>
                  <text x="80" y="372">Interacting</text>
                  <text x="80" y="388">App</text>
                  <text x="188" y="404">4.</text>
                  <text x="260" y="404">Authentication</text>
                  <text x="328" y="404">&amp;</text>
                  <text x="392" y="404">Authorization</text>
                  <text x="484" y="404">Response</text>
                  <text x="316" y="452">Mobile</text>
                  <text x="372" y="452">Device</text>
                </g>
              </svg><a href="#appendix-B.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-app2app-across-trust-domains" class="selfRef">App2App across trust domains using browser</a>
          </figcaption></figure>
</div>
<p id="appendix-B.1-2">Since no native app claims the urls of redirecting Authorization Servers (<em>OAuth Brokers</em>), mobile Operating Systems default to using the system browser as the User Agent.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="impact-of-using-a-web-browser">
<section id="appendix-B.2">
        <h3 id="name-impact-of-using-a-web-brows">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-impact-of-using-a-web-brows" class="section-name selfRef">Impact of using a web browser</a>
        </h3>
<p id="appendix-B.2-1">Using a web browser may degrade the user experience in several ways:<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.1">
            <p id="appendix-B.2-2.1.1">Some browser's support for deep links is limited by design, or by the settings used.<a href="#appendix-B.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.2">
            <p id="appendix-B.2-2.2.1">Browsers may prompt end-user for consent before opening apps claiming deep links, introducing additional friction.<a href="#appendix-B.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.3">
            <p id="appendix-B.2-2.3.1">Browsers are noticeable by end-users, rendering the UX less smooth.<a href="#appendix-B.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.4">
            <p id="appendix-B.2-2.4.1">Client app developers don't control which browser the <em>User-Interacting App</em> uses to provide its response to redirect_uri. Opinionated choices pose a risk that different browsers will use, making necessary cookies used to bind session identifiers to the user agent (nonce, state or PKCE verifier) unavailable, which may break the flow.<a href="#appendix-B.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.5">
            <p id="appendix-B.2-2.5.1">After flow completion, "orphan" browser tabs may remain. They do not directly impact the flow, but can be regarded as unnecessary "clutter".<a href="#appendix-B.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="relation-to-openidnative-sso">
<section id="appendix-B.3">
        <h3 id="name-relation-to">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-relation-to" class="section-name selfRef">Relation to <span class="cite xref">[OpenID.Native-SSO]</span></a>
        </h3>
<p id="appendix-B.3-1"><span>[<a href="#OpenID.Native-SSO" class="cite xref">OpenID.Native-SSO</a>]</span> also offers a native SSO flow across apps. However, it is limited to apps:<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.3-2.1">
            <p id="appendix-B.3-2.1.1">Published by the same issuer, therefore can securely share information.<a href="#appendix-B.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-2.2">
            <p id="appendix-B.3-2.2.1">Using the same Authorization Server.<a href="#appendix-B.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="relation-to-oauthfirst-party">
<section id="appendix-B.4">
        <h3 id="name-relation-to-2">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-relation-to-2" class="section-name selfRef">Relation to <span class="cite xref">[OAuth.First-Party]</span></a>
        </h3>
<p id="appendix-B.4-1"><span>[<a href="#OAuth.First-Party" class="cite xref">OAuth.First-Party</a>]</span> also deals with native apps, but it <span class="bcp14">MUST</span> only be used by first-party applications, which is when the authorization server and application are controlled by the same entity, which is not true in the case described in this document.<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
<p id="appendix-B.4-2">While this document also discusses a mechanism for <em>Authorization Servers</em> to guide <em>Client App</em> in obtaining user's input to guide routing the request across trust domains, the <span>[<a href="#OAuth.First-Party" class="cite xref">OAuth.First-Party</a>]</span> required high degree of trust between the authorization server and the client is not fulfilled.<a href="#appendix-B.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The authors would like to thank the following individuals who contributed ideas, feedback, and wording that shaped and formed the final specification: George Fletcher, Arndt Schwenkschuster, Henrik Kroll, Grese Hyseni.
As well as the attendees of the OAuth Security Workshop 2025 session in which this topic was discussed for their ideas and feedback.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-D">
      <h2 id="name-document-history">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-D-1">[[ To be removed from the final specification ]]<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">-latest<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-3.1">
          <p id="appendix-D-3.1.1">Re-added required support for cookies<a href="#appendix-D-3.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-4">-06<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-5.1">
          <p id="appendix-D-5.1.1">Replaced Authorization Details Type with a new parameter<a href="#appendix-D-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.2">
          <p id="appendix-D-5.2.1">native_authorization_endpoint as REST API - no cookies or HTTP 30x responses<a href="#appendix-D-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-6">-05<a href="#appendix-D-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-7.1">
          <p id="appendix-D-7.1.1">removed error native_callback_uri_not_claimed<a href="#appendix-D-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-7.2">
          <p id="appendix-D-7.2.1">Added Routing Instructions Response<a href="#appendix-D-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-7.3">
          <p id="appendix-D-7.3.1">Added native_authorization_endpoint and matching AS profile<a href="#appendix-D-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-7.4">
          <p id="appendix-D-7.4.1">Added Authorization Details Type as container for native_callback_uri<a href="#appendix-D-7.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-8">-04<a href="#appendix-D-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-9.1">
          <p id="appendix-D-9.1.1">Phrased the challenge in Trust Domain terminology<a href="#appendix-D-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-9.2">
          <p id="appendix-D-9.2.1">Discussed interim Authorization Server interacting the end-user, which is not the User-Authenticating Authorization Server<a href="#appendix-D-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-9.3">
          <p id="appendix-D-9.3.1">Moved Cookies topic to Protocol Flow<a href="#appendix-D-9.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-9.4">
          <p id="appendix-D-9.4.1">Mentioned that Authorization Servers redirecting not through HTTP 30x force the use of a browser<a href="#appendix-D-9.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-9.5">
          <p id="appendix-D-9.5.1">Discussed Embedded user agents security consideration<a href="#appendix-D-9.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-10">-03<a href="#appendix-D-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-11.1">
          <p id="appendix-D-11.1.1">Defined parameters and values<a href="#appendix-D-11.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-11.2">
          <p id="appendix-D-11.2.1">Added error native_callback_uri_not_claimed<a href="#appendix-D-11.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-12">-02<a href="#appendix-D-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-13.1">
          <p id="appendix-D-13.1.1">Clarified wording<a href="#appendix-D-13.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-13.2">
          <p id="appendix-D-13.2.1">Improved figures<a href="#appendix-D-13.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-14">-01<a href="#appendix-D-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-15.1">
          <p id="appendix-D-15.1.1">Better defined terms<a href="#appendix-D-15.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-15.2">
          <p id="appendix-D-15.2.1">Explained deep link claiming detection on iOS and android<a href="#appendix-D-15.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-16">-00<a href="#appendix-D-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-17.1">
          <p id="appendix-D-17.1.1">initial working group version (previously draft-zehavi-oauth-app2app-browserless)<a href="#appendix-D-17.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yaron Zehavi</span></div>
<div dir="auto" class="left"><span class="org">Raiffeisen Bank International</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yaron.zehavi@rbinternational.com" class="email">yaron.zehavi@rbinternational.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
