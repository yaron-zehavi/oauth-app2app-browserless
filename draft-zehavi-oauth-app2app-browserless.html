<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 App2App Browserless Flow</title>
<meta content="Yaron Zehavi" name="author">
<meta content="
       This document describes a protocol connecting 2 native apps via the OAuth   pattern, to achieve native user navigation (no web browser required), regardless of any number of OAuth brokers federating the request across trust domains. 
    " name="description">
<meta content="xml2rfc 3.30.0" name="generator">
<meta content="native-apps" name="keyword">
<meta content="oauth" name="keyword">
<meta content="app2app" name="keyword">
<meta content="browserless" name="keyword">
<meta content="draft-zehavi-oauth-app2app-browserless-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.30.0
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-zehavi-oauth-app2app-browserless.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Native OAuth App2App</td>
<td class="right">July 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Zehavi</td>
<td class="center">Expires 28 January 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-zehavi-oauth-app2app-browserless-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-07-27" class="published">27 July 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-01-28">28 January 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Zehavi</div>
<div class="org">Raiffeisen Bank International</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 App2App Browserless Flow</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a protocol connecting 2 native apps via the OAuth <span>[<a href="#App2App" class="cite xref">App2App</a>]</span> pattern, to achieve native user navigation (no web browser required), regardless of any number of OAuth brokers federating the request across trust domains.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://yaron-zehavi.github.io/oauth-app2app-browserless/draft-zehavi-oauth-app2app-browserless.html">https://yaron-zehavi.github.io/oauth-app2app-browserless/draft-zehavi-oauth-app2app-browserless.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-zehavi-oauth-app2app-browserless/">https://datatracker.ietf.org/doc/draft-zehavi-oauth-app2app-browserless/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Web Authorization Protocol Working Group mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/yaron-zehavi/oauth-app2app-browserless">https://github.com/yaron-zehavi/oauth-app2app-browserless</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 January 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-difference-from-openidnativ" class="internal xref">Difference from OpenID.Native-SSO</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-challenge-of-app2app-with-o" class="internal xref">Challenge of App2App with OAuth Brokers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-app2app-with-oauth-brokers-" class="internal xref">App2App with OAuth Brokers requires a web browser</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-impact-of-using-a-web-brows" class="internal xref">Impact of using a web browser</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-app2web-with-brokers" class="internal xref">App2Web with brokers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-browser-less-app2app-with-o" class="internal xref">Browser-less App2App with OAuth Brokers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-flow-diagram" class="internal xref">Flow Diagram</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-new-parameters-and-values" class="internal xref">New Parameters and Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-validation-of-native_callba" class="internal xref">Validation of native_callback_uri</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-protocol-flow" class="internal xref">Protocol Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="auto internal xref">5.4.1</a>.  <a href="#name-client-app-calls-initial-au" class="internal xref">Client App calls Initial Authorization Server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="auto internal xref">5.4.2</a>.  <a href="#name-initial-authorization-serve" class="internal xref">Initial Authorization Server returns authorization request to Downstream Authorization Server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.3">
                    <p id="section-toc.1-1.5.2.4.2.3.1"><a href="#section-5.4.3" class="auto internal xref">5.4.3</a>.  <a href="#name-client-app-invokes-app-of-u" class="internal xref">Client App invokes app of User-Interacting Authorization Server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.4">
                    <p id="section-toc.1-1.5.2.4.2.4.1"><a href="#section-5.4.4" class="auto internal xref">5.4.4</a>.  <a href="#name-fallback-to-using-the-brows" class="internal xref">Fallback to using the browser</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.5">
                    <p id="section-toc.1-1.5.2.4.2.5.1"><a href="#section-5.4.5" class="auto internal xref">5.4.5</a>.  <a href="#name-processing-by-user-interact" class="internal xref">Processing by User-Interacting Authorization Server's App:</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.6">
                    <p id="section-toc.1-1.5.2.4.2.6.1"><a href="#section-5.4.6" class="auto internal xref">5.4.6</a>.  <a href="#name-client-app-traverses-oauth-" class="internal xref">Client App traverses OAuth Brokers in reverse order</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.7">
                    <p id="section-toc.1-1.5.2.4.2.7.1"><a href="#section-5.4.7" class="auto internal xref">5.4.7</a>.  <a href="#name-client-app-obtains-response" class="internal xref">Client App obtains response</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-detecting-presence-of-nativ" class="internal xref">Detecting Presence of Native Apps claiming Urls</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-android" class="internal xref">Android</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-ios" class="internal xref">iOS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-embedded-user-agents" class="internal xref">Embedded User Agents</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-oauth-request-forgery-and-m" class="internal xref">OAuth request forgery and manipulation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-secure-native-application-c" class="internal xref">Secure Native application communication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-deep-link-hijacking" class="internal xref">Deep link hijacking</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-open-redirection-by-client-" class="internal xref">Open redirection by Client App</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-open-redirection-by-user-in" class="internal xref">Open redirection by User-Interacting Authorization Server's App</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-authorization-code-theft-an" class="internal xref">Authorization code theft and injection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document, <em>OAuth 2.0 App2App Browserless Flow</em> (Native App2App), presents a protocol enabling native OAuth <span>[<a href="#App2App" class="cite xref">App2App</a>]</span> <strong>browser-less</strong> navigation across apps.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">It addresses the challenges presented when using a web browser to navigate through <strong>one or more</strong> Brokering Authorization Servers:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">Such <em>OAuth Brokers</em> are required when <em>Client App</em> is not an OAuth client of the <em>User-Interacting Authorization Server</em> and so they federate the flow across trust domains.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">Since no app owns <em>OAuth Brokers'</em> urls, App2App flows involving brokers require a web browser, which degrades the user experience.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">This document specifies:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">
          <p id="section-1-5.1.1">A new parameter to the authorization endpoint: <strong>native_callback_uri</strong>.<a href="#section-1-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.2">
          <p id="section-1-5.2.1">A new scope value: <strong>app2app</strong>.<a href="#section-1-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-5.3">
          <p id="section-1-5.3.1">A new error_description value: <strong>native_callback_uri_not_claimed</strong>.<a href="#section-1-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="difference-from-openidnative-sso">
<section id="section-1.1">
        <h3 id="name-difference-from-openidnativ">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-difference-from-openidnativ" class="section-name selfRef">Difference from OpenID.Native-SSO</a>
        </h3>
<p id="section-1.1-1"><span>[<a href="#OpenID.Native-SSO" class="cite xref">OpenID.Native-SSO</a>]</span> also offers a native SSO flow across apps. However, it is limited to apps:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
            <p id="section-1.1-2.1.1">Published by the same issuer, therefore can securely share information.<a href="#section-1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">Using the same Authorization Server.<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">In addition to the terms defined in referenced specifications, this document uses
the following terms:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-2">
          <dt id="section-1.2-2.1">"OAuth":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">In this document, "OAuth" refers to OAuth 2.0, <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and <span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span> as well as <span>[<a href="#OpenID" class="cite xref">OpenID</a>]</span>, both in their <strong>authorization code flow</strong>.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.3">"PKCE":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.4">
            <p id="section-1.2-2.4.1">Proof Key for Code Exchange (PKCE) <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>, a mechanism
to prevent various attacks on OAuth authorization codes.<a href="#section-1.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.5">"OAuth Broker":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.6">
            <p id="section-1.2-2.6.1">A component acting as an Authorization Server for its clients, as well as an OAuth Client towards <em>Downstream Authorization Servers</em>.
Brokers are used to facilitate a trust relationship when there is no direct relation between an OAuth Client and the final Authorization Server where end-user authenticates and authorizes.
This pattern is in current use to establish trust in federation use cases in Academia and in the business world, across corporations.
Note: It is possible OAuth Brokers will be superseded in the future by <span>[<a href="#OpenID.Federation" class="cite xref">OpenID.Federation</a>]</span>, offering dynamic trust establishment.<a href="#section-1.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.7">"Client App":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.8">
            <p id="section-1.2-2.8.1">A Native app implementing "OAuth 2.0 for Native Apps" <span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span> as an OAuth client of <em>Initial Authorization Server</em>. Client's redirect_uri is claimed by the app.<a href="#section-1.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.9">"Initial Authorization Server":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.10">
            <p id="section-1.2-2.10.1">The Authorization Server of <em>Client App</em> which acts as an <em>OAuth Broker</em> as an OAuth client of a <em>Downstream Authorization Server</em>.<a href="#section-1.2-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.11">"Downstream Authorization Server":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.12">
            <p id="section-1.2-2.12.1">An Authorization Server which may be an <em>OAuth Broker</em> or a <em>User-Interacting Authorization Server</em>.<a href="#section-1.2-2.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.13">"User-Interacting Authorization Server":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.14">
            <p id="section-1.2-2.14.1">An Authorization Server which interacts with end-user. The interaction may be interim navigation (e.g: user input guides where to redirect), or user authentication and request authorization.<a href="#section-1.2-2.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.15">"User-Interacting App":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.16">
            <p id="section-1.2-2.16.1">Native App of <em>User-Interacting Authorization Server</em>.<a href="#section-1.2-2.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.17">"Deep Link":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.18">
            <p id="section-1.2-2.18.1">A url claimed by a native application.<a href="#section-1.2-2.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.19">"Native Callback uri":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.20">
            <p id="section-1.2-2.20.1"><em>Client App's</em> redirect_uri, claimed as a deep link. This deep link is invoked by <em>User-Interacting App</em> to natively return to <em>Client App</em>.<a href="#section-1.2-2.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="challenge-of-app2app-with-oauth-brokers">
<section id="section-3">
      <h2 id="name-challenge-of-app2app-with-o">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-challenge-of-app2app-with-o" class="section-name selfRef">Challenge of App2App with OAuth Brokers</a>
      </h2>
<div id="app2app-with-oauth-brokers-requires-a-web-browser">
<section id="section-3.1">
        <h3 id="name-app2app-with-oauth-brokers-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-app2app-with-oauth-brokers-" class="section-name selfRef">App2App with OAuth Brokers requires a web browser</a>
        </h3>
<span id="name-app2app-with-brokers-and-br"></span><div id="app2app-w-brokers-and-browser">
<figure id="figure-1">
          <div id="section-3.1-1.1">
            <div class="alignLeft art-svg artwork" id="section-3.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="448" width="760" viewBox="0 0 760 448" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,416" fill="none" stroke="black"></path>
                <path d="M 24,48 L 24,96" fill="none" stroke="black"></path>
                <path d="M 24,320 L 24,384" fill="none" stroke="black"></path>
                <path d="M 40,104 L 40,224" fill="none" stroke="black"></path>
                <path d="M 88,96 L 88,192" fill="none" stroke="black"></path>
                <path d="M 112,48 L 112,96" fill="none" stroke="black"></path>
                <path d="M 128,144 L 128,288" fill="none" stroke="black"></path>
                <path d="M 136,320 L 136,384" fill="none" stroke="black"></path>
                <path d="M 144,160 L 144,240" fill="none" stroke="black"></path>
                <path d="M 264,160 L 264,240" fill="none" stroke="black"></path>
                <path d="M 328,160 L 328,240" fill="none" stroke="black"></path>
                <path d="M 344,240 L 344,256" fill="none" stroke="black"></path>
                <path d="M 456,160 L 456,240" fill="none" stroke="black"></path>
                <path d="M 472,176 L 472,256" fill="none" stroke="black"></path>
                <path d="M 544,160 L 544,256" fill="none" stroke="black"></path>
                <path d="M 592,256 L 592,336" fill="none" stroke="black"></path>
                <path d="M 648,264 L 648,368" fill="none" stroke="black"></path>
                <path d="M 712,160 L 712,256" fill="none" stroke="black"></path>
                <path d="M 736,144 L 736,288" fill="none" stroke="black"></path>
                <path d="M 752,32 L 752,416" fill="none" stroke="black"></path>
                <path d="M 8,32 L 752,32" fill="none" stroke="black"></path>
                <path d="M 24,48 L 112,48" fill="none" stroke="black"></path>
                <path d="M 24,96 L 112,96" fill="none" stroke="black"></path>
                <path d="M 128,144 L 736,144" fill="none" stroke="black"></path>
                <path d="M 144,160 L 264,160" fill="none" stroke="black"></path>
                <path d="M 328,160 L 456,160" fill="none" stroke="black"></path>
                <path d="M 544,160 L 712,160" fill="none" stroke="black"></path>
                <path d="M 456,176 L 472,176" fill="none" stroke="black"></path>
                <path d="M 88,192 L 136,192" fill="none" stroke="black"></path>
                <path d="M 264,192 L 320,192" fill="none" stroke="black"></path>
                <path d="M 472,192 L 536,192" fill="none" stroke="black"></path>
                <path d="M 40,224 L 144,224" fill="none" stroke="black"></path>
                <path d="M 272,224 L 328,224" fill="none" stroke="black"></path>
                <path d="M 480,224 L 544,224" fill="none" stroke="black"></path>
                <path d="M 144,240 L 264,240" fill="none" stroke="black"></path>
                <path d="M 328,240 L 456,240" fill="none" stroke="black"></path>
                <path d="M 344,256 L 472,256" fill="none" stroke="black"></path>
                <path d="M 544,256 L 712,256" fill="none" stroke="black"></path>
                <path d="M 128,288 L 736,288" fill="none" stroke="black"></path>
                <path d="M 24,320 L 136,320" fill="none" stroke="black"></path>
                <path d="M 144,336 L 592,336" fill="none" stroke="black"></path>
                <path d="M 136,368 L 648,368" fill="none" stroke="black"></path>
                <path d="M 24,384 L 136,384" fill="none" stroke="black"></path>
                <path d="M 8,416 L 752,416" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="656,264 644,258.4 644,269.6" fill="black" transform="rotate(270,648,264)"></polygon>
                <polygon class="arrowhead" points="544,192 532,186.4 532,197.6" fill="black" transform="rotate(0,536,192)"></polygon>
                <polygon class="arrowhead" points="488,224 476,218.4 476,229.6" fill="black" transform="rotate(180,480,224)"></polygon>
                <polygon class="arrowhead" points="328,192 316,186.4 316,197.6" fill="black" transform="rotate(0,320,192)"></polygon>
                <polygon class="arrowhead" points="280,224 268,218.4 268,229.6" fill="black" transform="rotate(180,272,224)"></polygon>
                <polygon class="arrowhead" points="152,336 140,330.4 140,341.6" fill="black" transform="rotate(180,144,336)"></polygon>
                <polygon class="arrowhead" points="144,192 132,186.4 132,197.6" fill="black" transform="rotate(0,136,192)"></polygon>
                <polygon class="arrowhead" points="48,104 36,98.4 36,109.6" fill="black" transform="rotate(270,40,104)"></polygon>
                <g class="text">
                  <text x="68" y="68">Client</text>
                  <text x="64" y="84">App</text>
                  <text x="124" y="116">Launch</text>
                  <text x="208" y="116">Authorization</text>
                  <text x="128" y="132">Request</text>
                  <text x="172" y="132">on</text>
                  <text x="216" y="132">Browser</text>
                  <text x="388" y="132">Mobile</text>
                  <text x="448" y="132">Browser</text>
                  <text x="296" y="164">Auth.</text>
                  <text x="512" y="164">Auth.</text>
                  <text x="208" y="180">Initial</text>
                  <text x="292" y="180">Req.</text>
                  <text x="396" y="180">Downstream</text>
                  <text x="508" y="180">Req.</text>
                  <text x="624" y="180">User-</text>
                  <text x="208" y="196">Authorization</text>
                  <text x="400" y="196">Authorization</text>
                  <text x="628" y="196">Authenticating</text>
                  <text x="204" y="212">Server</text>
                  <text x="392" y="212">Servers</text>
                  <text x="624" y="212">Authorization</text>
                  <text x="620" y="228">Server</text>
                  <text x="72" y="244">Authorization</text>
                  <text x="296" y="244">Auth.</text>
                  <text x="512" y="244">Auth.</text>
                  <text x="68" y="260">Response</text>
                  <text x="292" y="260">Response</text>
                  <text x="508" y="260">Response</text>
                  <text x="48" y="276">(Deep</text>
                  <text x="96" y="276">Link)</text>
                  <text x="244" y="324">Authenticate</text>
                  <text x="304" y="324">&amp;</text>
                  <text x="352" y="324">Authorize</text>
                  <text x="416" y="324">(Deep</text>
                  <text x="464" y="324">Link)</text>
                  <text x="80" y="340">User-</text>
                  <text x="80" y="356">Interacting</text>
                  <text x="80" y="372">App</text>
                  <text x="252" y="388">Authentication</text>
                  <text x="320" y="388">&amp;</text>
                  <text x="384" y="388">Authorization</text>
                  <text x="476" y="388">Response</text>
                  <text x="316" y="436">Mobile</text>
                  <text x="372" y="436">Device</text>
                </g>
              </svg><a href="#section-3.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-app2app-with-brokers-and-br" class="selfRef">App2App with brokers and browser (redirects back to Client not depicted)</a>
          </figcaption></figure>
</div>
<p id="section-3.1-2">Since no native app claims <em>OAuth Brokers'</em> urls, OAuth requests and redirect_uri responses to and from <em>OAuth Brokers</em> are handled by a web browser as the User Agent.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="impact-of-using-a-web-browser">
<section id="section-3.2">
        <h3 id="name-impact-of-using-a-web-brows">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-impact-of-using-a-web-brows" class="section-name selfRef">Impact of using a web browser</a>
        </h3>
<p id="section-3.2-1">Using a web browser may degrade the user experience in several ways:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">Some browser's support for deep links is limited by design, or by the settings used.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">The browser may prompt end-user for consent before opening deep links, introducing additional friction.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">Browser's loading of urls and redirecting may be noticeable by end-user, rendering the UX less smooth.<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">App developers cannot control which browser will handle the response redirect_uri. This poses a risk that necessary cookies used to bind session identifiers to the user agent (nonce, state or PKCE verifier) will be unavailable, which may break the flow.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.5">
            <p id="section-3.2-2.5.1">After the flow is complete, "orphan" browser tabs might remain. While they do not directly impact the flow, they can be regarded as unnecessary "clutter".<a href="#section-3.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="app2web-with-brokers">
<section id="section-4">
      <h2 id="name-app2web-with-brokers">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-app2web-with-brokers" class="section-name selfRef">App2Web with brokers</a>
      </h2>
<span id="name-app2web-with-brokers-redire"></span><div id="app2web-w-brokers">
<figure id="figure-2">
        <div id="section-4-1.1">
          <div class="alignLeft art-svg artwork" id="section-4-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="384" width="760" viewBox="0 0 760 384" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,352" fill="none" stroke="black"></path>
              <path d="M 24,48 L 24,96" fill="none" stroke="black"></path>
              <path d="M 40,104 L 40,224" fill="none" stroke="black"></path>
              <path d="M 88,96 L 88,192" fill="none" stroke="black"></path>
              <path d="M 112,48 L 112,96" fill="none" stroke="black"></path>
              <path d="M 128,144 L 128,336" fill="none" stroke="black"></path>
              <path d="M 144,160 L 144,240" fill="none" stroke="black"></path>
              <path d="M 264,160 L 264,240" fill="none" stroke="black"></path>
              <path d="M 328,160 L 328,240" fill="none" stroke="black"></path>
              <path d="M 344,240 L 344,256" fill="none" stroke="black"></path>
              <path d="M 456,160 L 456,240" fill="none" stroke="black"></path>
              <path d="M 472,176 L 472,256" fill="none" stroke="black"></path>
              <path d="M 544,160 L 544,256" fill="none" stroke="black"></path>
              <path d="M 560,256 L 560,288" fill="none" stroke="black"></path>
              <path d="M 696,256 L 696,288" fill="none" stroke="black"></path>
              <path d="M 712,160 L 712,256" fill="none" stroke="black"></path>
              <path d="M 736,144 L 736,336" fill="none" stroke="black"></path>
              <path d="M 752,32 L 752,352" fill="none" stroke="black"></path>
              <path d="M 8,32 L 752,32" fill="none" stroke="black"></path>
              <path d="M 24,48 L 112,48" fill="none" stroke="black"></path>
              <path d="M 24,96 L 112,96" fill="none" stroke="black"></path>
              <path d="M 128,144 L 736,144" fill="none" stroke="black"></path>
              <path d="M 144,160 L 264,160" fill="none" stroke="black"></path>
              <path d="M 328,160 L 456,160" fill="none" stroke="black"></path>
              <path d="M 544,160 L 712,160" fill="none" stroke="black"></path>
              <path d="M 456,176 L 472,176" fill="none" stroke="black"></path>
              <path d="M 88,192 L 136,192" fill="none" stroke="black"></path>
              <path d="M 264,192 L 320,192" fill="none" stroke="black"></path>
              <path d="M 472,192 L 536,192" fill="none" stroke="black"></path>
              <path d="M 40,224 L 144,224" fill="none" stroke="black"></path>
              <path d="M 272,224 L 328,224" fill="none" stroke="black"></path>
              <path d="M 480,224 L 544,224" fill="none" stroke="black"></path>
              <path d="M 144,240 L 264,240" fill="none" stroke="black"></path>
              <path d="M 328,240 L 456,240" fill="none" stroke="black"></path>
              <path d="M 344,256 L 472,256" fill="none" stroke="black"></path>
              <path d="M 544,256 L 712,256" fill="none" stroke="black"></path>
              <path d="M 560,288 L 696,288" fill="none" stroke="black"></path>
              <path d="M 128,336 L 736,336" fill="none" stroke="black"></path>
              <path d="M 8,352 L 752,352" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="544,192 532,186.4 532,197.6" fill="black" transform="rotate(0,536,192)"></polygon>
              <polygon class="arrowhead" points="488,224 476,218.4 476,229.6" fill="black" transform="rotate(180,480,224)"></polygon>
              <polygon class="arrowhead" points="328,192 316,186.4 316,197.6" fill="black" transform="rotate(0,320,192)"></polygon>
              <polygon class="arrowhead" points="280,224 268,218.4 268,229.6" fill="black" transform="rotate(180,272,224)"></polygon>
              <polygon class="arrowhead" points="144,192 132,186.4 132,197.6" fill="black" transform="rotate(0,136,192)"></polygon>
              <polygon class="arrowhead" points="48,104 36,98.4 36,109.6" fill="black" transform="rotate(270,40,104)"></polygon>
              <g class="text">
                <text x="68" y="68">Client</text>
                <text x="64" y="84">App</text>
                <text x="124" y="116">Launch</text>
                <text x="208" y="116">Authorization</text>
                <text x="128" y="132">Request</text>
                <text x="172" y="132">on</text>
                <text x="216" y="132">Browser</text>
                <text x="388" y="132">Mobile</text>
                <text x="448" y="132">Browser</text>
                <text x="296" y="164">Auth.</text>
                <text x="512" y="164">Auth.</text>
                <text x="208" y="180">Initial</text>
                <text x="292" y="180">Req.</text>
                <text x="396" y="180">Downstream</text>
                <text x="508" y="180">Req.</text>
                <text x="624" y="180">User-</text>
                <text x="208" y="196">Authorization</text>
                <text x="400" y="196">Authorization</text>
                <text x="628" y="196">Authenticating</text>
                <text x="204" y="212">Server</text>
                <text x="392" y="212">Servers</text>
                <text x="624" y="212">Authorization</text>
                <text x="620" y="228">Server</text>
                <text x="72" y="244">Authorization</text>
                <text x="296" y="244">Auth.</text>
                <text x="512" y="244">Auth.</text>
                <text x="68" y="260">Response</text>
                <text x="292" y="260">Response</text>
                <text x="508" y="260">Response</text>
                <text x="48" y="276">(Deep</text>
                <text x="96" y="276">Link)</text>
                <text x="616" y="276">Web</text>
                <text x="644" y="276">UI</text>
                <text x="628" y="308">Authenticate</text>
                <text x="584" y="324">&amp;</text>
                <text x="632" y="324">Authorize</text>
                <text x="316" y="372">Mobile</text>
                <text x="372" y="372">Device</text>
              </g>
            </svg><a href="#section-4-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-app2web-with-brokers-redire" class="selfRef">App2Web with brokers (redirects back to Client not depicted)</a>
        </figcaption></figure>
</div>
<p id="section-4-2">End-user's device may not have an app claiming <em>User-Interacting Authorization Server's</em> urls, when:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <p id="section-4-3.1.1"><em>User-Interacting Authorization Server</em> offers no native app.<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.2">
          <p id="section-4-3.2.1">Or such an app is offered, but is not installed on the end-user's device.<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-4">In such case interacting with <em>User-Interacting Authorization Server's</em> <span class="bcp14">MUST</span> use the browser as user agent.
This is similar to the flow described in "OAuth 2.0 for Native Apps" <span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span>, and referred to in <span>[<a href="#App2App" class="cite xref">App2App</a>]</span> as <strong>App2Web</strong>, and is therefore not discussed further in this document.<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="browser-less-app2app-with-oauth-brokers">
<section id="section-5">
      <h2 id="name-browser-less-app2app-with-o">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-browser-less-app2app-with-o" class="section-name selfRef">Browser-less App2App with OAuth Brokers</a>
      </h2>
<div id="flow-diagram">
<section id="section-5.1">
        <h3 id="name-flow-diagram">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-flow-diagram" class="section-name selfRef">Flow Diagram</a>
        </h3>
<span id="name-browser-less-app2app-with-b"></span><div id="app2app-browserless-w-brokers">
<figure id="figure-3">
          <div id="section-5.1-1.1">
            <div class="alignLeft art-svg artwork" id="section-5.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="448" width="424" viewBox="0 0 424 448" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,416" fill="none" stroke="black"></path>
                <path d="M 24,96 L 24,160" fill="none" stroke="black"></path>
                <path d="M 24,320 L 24,400" fill="none" stroke="black"></path>
                <path d="M 40,168 L 40,312" fill="none" stroke="black"></path>
                <path d="M 72,168 L 72,312" fill="none" stroke="black"></path>
                <path d="M 104,168 L 104,224" fill="none" stroke="black"></path>
                <path d="M 120,64 L 120,88" fill="none" stroke="black"></path>
                <path d="M 120,168 L 120,208" fill="none" stroke="black"></path>
                <path d="M 144,96 L 144,160" fill="none" stroke="black"></path>
                <path d="M 160,320 L 160,400" fill="none" stroke="black"></path>
                <path d="M 264,48 L 264,144" fill="none" stroke="black"></path>
                <path d="M 264,192 L 264,288" fill="none" stroke="black"></path>
                <path d="M 264,320 L 264,400" fill="none" stroke="black"></path>
                <path d="M 392,48 L 392,144" fill="none" stroke="black"></path>
                <path d="M 392,192 L 392,288" fill="none" stroke="black"></path>
                <path d="M 392,320 L 392,400" fill="none" stroke="black"></path>
                <path d="M 416,32 L 416,416" fill="none" stroke="black"></path>
                <path d="M 8,32 L 416,32" fill="none" stroke="black"></path>
                <path d="M 264,48 L 392,48" fill="none" stroke="black"></path>
                <path d="M 120,64 L 256,64" fill="none" stroke="black"></path>
                <path d="M 24,96 L 144,96" fill="none" stroke="black"></path>
                <path d="M 152,112 L 256,112" fill="none" stroke="black"></path>
                <path d="M 152,128 L 256,128" fill="none" stroke="black"></path>
                <path d="M 264,144 L 392,144" fill="none" stroke="black"></path>
                <path d="M 24,160 L 144,160" fill="none" stroke="black"></path>
                <path d="M 264,192 L 392,192" fill="none" stroke="black"></path>
                <path d="M 120,208 L 256,208" fill="none" stroke="black"></path>
                <path d="M 104,224 L 256,224" fill="none" stroke="black"></path>
                <path d="M 264,288 L 392,288" fill="none" stroke="black"></path>
                <path d="M 24,320 L 160,320" fill="none" stroke="black"></path>
                <path d="M 264,320 L 392,320" fill="none" stroke="black"></path>
                <path d="M 168,352 L 256,352" fill="none" stroke="black"></path>
                <path d="M 24,400 L 160,400" fill="none" stroke="black"></path>
                <path d="M 264,400 L 392,400" fill="none" stroke="black"></path>
                <path d="M 8,416 L 416,416" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="264,352 252,346.4 252,357.6" fill="black" transform="rotate(0,256,352)"></polygon>
                <polygon class="arrowhead" points="264,224 252,218.4 252,229.6" fill="black" transform="rotate(0,256,224)"></polygon>
                <polygon class="arrowhead" points="264,208 252,202.4 252,213.6" fill="black" transform="rotate(0,256,208)"></polygon>
                <polygon class="arrowhead" points="264,112 252,106.4 252,117.6" fill="black" transform="rotate(0,256,112)"></polygon>
                <polygon class="arrowhead" points="264,64 252,58.4 252,69.6" fill="black" transform="rotate(0,256,64)"></polygon>
                <polygon class="arrowhead" points="176,352 164,346.4 164,357.6" fill="black" transform="rotate(180,168,352)"></polygon>
                <polygon class="arrowhead" points="160,128 148,122.4 148,133.6" fill="black" transform="rotate(180,152,128)"></polygon>
                <polygon class="arrowhead" points="128,168 116,162.4 116,173.6" fill="black" transform="rotate(270,120,168)"></polygon>
                <polygon class="arrowhead" points="112,168 100,162.4 100,173.6" fill="black" transform="rotate(270,104,168)"></polygon>
                <polygon class="arrowhead" points="80,312 68,306.4 68,317.6" fill="black" transform="rotate(90,72,312)"></polygon>
                <polygon class="arrowhead" points="48,168 36,162.4 36,173.6" fill="black" transform="rotate(270,40,168)"></polygon>
                <g class="text">
                  <text x="192" y="52">(8)</text>
                  <text x="328" y="68">Initial</text>
                  <text x="328" y="84">Authorization</text>
                  <text x="192" y="100">(1)</text>
                  <text x="324" y="100">Server</text>
                  <text x="84" y="116">Client</text>
                  <text x="80" y="132">App</text>
                  <text x="300" y="132">(OAuth</text>
                  <text x="360" y="132">Broker)</text>
                  <text x="192" y="148">(2)</text>
                  <text x="192" y="196">(3)</text>
                  <text x="316" y="228">Downstream</text>
                  <text x="192" y="244">(7)</text>
                  <text x="328" y="244">Authorization</text>
                  <text x="304" y="260">Servers</text>
                  <text x="24" y="292">(6)</text>
                  <text x="88" y="292">(4)</text>
                  <text x="328" y="340">User-</text>
                  <text x="96" y="356">User-</text>
                  <text x="332" y="356">Authenticating</text>
                  <text x="92" y="372">Authenticating</text>
                  <text x="192" y="372">(5)</text>
                  <text x="328" y="372">Authorization</text>
                  <text x="96" y="388">App</text>
                  <text x="300" y="388">Server</text>
                  <text x="172" y="436">Mobile</text>
                  <text x="228" y="436">Device</text>
                </g>
              </svg><a href="#section-5.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-browser-less-app2app-with-b" class="selfRef">Browser-less App2App with Brokers</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">(1) <em>Client App</em> presents an authorization request to <em>Initial Authorization Server</em>, indicating app2app flow using new scope value <strong>app2app</strong>.<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">(2) <em>Initial Authorization Server</em> returns an authorization request for Downstream Authorization Server, including Client App's redirect_uri as <strong>native_callback_uri</strong>.<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.3">
            <p id="section-5.1-2.3.1">(3) <em>Client App</em> checks if the returned authorization request url is claimed by an app on the device and if so proceeds to the next step. Otherwise it loops through Downstream Authorization Servers, calling their authorization endpoints and processing their HTTP 3xx redirect responses, until a url claimed by an app on the device is reached.<a href="#section-5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.4">
            <p id="section-5.1-2.4.1">(4) <em>Client App</em> natively invokes <em>User-Interacting App</em>.<a href="#section-5.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.5">
            <p id="section-5.1-2.5.1">(5) <em>User-Interacting App</em> authenticates user and authorizes the request.<a href="#section-5.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.6">
            <p id="section-5.1-2.6.1">(6) <em>User-Interacting App</em> natively invokes <strong>native_callback_uri</strong> (overriding the request's redirect_uri), providing as a parameter the redirect_uri with its response parameters.<a href="#section-5.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.7">
            <p id="section-5.1-2.7.1">(7) <em>Client App</em> loops through Authorization Servers in reverse order, starting from the redirect_uri it received from the <em>User-Interacting App</em>. It calls the first redirect_uri and any subsequent uri obtained as 3xx redirect directive, until it obtains a location header indicating its own redirect_uri.<a href="#section-5.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.8">
            <p id="section-5.1-2.8.1">(8) <em>Client App</em> exchanges code for tokens and the flow is complete.<a href="#section-5.1-2.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="parameters">
<section id="section-5.2">
        <h3 id="name-new-parameters-and-values">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-new-parameters-and-values" class="section-name selfRef">New Parameters and Values</a>
        </h3>
<p id="section-5.2-1">The protocol described in this document requires <strong>User-Interacting App</strong> to natively navigate end-user back to Client App, for which it requires Client App's <strong>native_callback_uri</strong>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Therefore this document defines new parameters and values.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-3">
          <dt id="section-5.2-3.1">"<strong>app2app</strong>":</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-3.2">
            <p id="section-5.2-3.2.1">New scope value, used by <em>Client App</em> to request an app2app flow from <em>Initial Authorization Server</em>.<a href="#section-5.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-4"><em>Initial Authorization Server</em>, processing an app2app flow according to this document, <span class="bcp14">MUST</span> provide Client App's redirect_uri as Native Callback uri to <em>Downstream Authorization Server</em> using one of the following options:<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-5">
          <dt id="section-5.2-5.1">"<strong>native_callback_uri</strong>":</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.2">
            <p id="section-5.2-5.2.1"><span class="bcp14">OPTIONAL</span>. New authorization endpoint request parameter. When <strong>native_callback_uri</strong> is provided, structured scope <strong>app2app:native_callback_uri</strong> <span class="bcp14">MUST NOT</span> be provided.<a href="#section-5.2-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-5.3">"<strong>app2app:{<em>native_callback_uri</em>}</strong>":</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-5.4">
            <p id="section-5.2-5.4.1"><span class="bcp14">OPTIONAL</span>. New structured scope value including the <strong>app2app</strong> flag as well as the Client's <strong>native_callback_uri</strong>, separated by a colon. When structured scope <strong>app2app:{<em>native_callback_uri</em>}</strong> is provided, <strong>native_callback_uri</strong> <span class="bcp14">MUST NOT</span> be provided.<a href="#section-5.2-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-6"><strong>native_callback_uri</strong> accepts the following query parameter when invoked by <em>User-Interacting Authorization Server's App</em>:<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-7">
          <dt id="section-5.2-7.1">"<strong>redirect_uri</strong>":</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-7.2">
            <p id="section-5.2-7.2.1">url-encoded OAuth redirect_uri with its response parameters.<a href="#section-5.2-7.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-8"><em>Downstream Authorization Server</em>, processing an app2app flow according to this document:<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-9.1">
            <p id="section-5.2-9.1.1"><span class="bcp14">MUST</span> retain the <strong>native_callback_uri</strong> in downstream authorization requests created.<a href="#section-5.2-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-9.2">
            <p id="section-5.2-9.2.1"><span class="bcp14">MAY</span> validate <strong>native_callback_uri</strong>.<a href="#section-5.2-9.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-10"><strong>Note</strong>: A simplification is considered, to replace these options and the validation logic by <em>Initial Authorization Server</em>, by having <em>Client App</em> provide the <strong>native_callback_uri</strong> through a <span>[<a href="#RFC9396" class="cite xref">RFC9396</a>]</span> rich authorization details type, which is expected to be passed on by <em>Downstream Authorization Servers</em>:<a href="#section-5.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-11">
<pre>
{
   "type": "https://scheme.example.org/native_callback_uri",
   "locations": [
      "https://app.example.com/native_callback_uri"
   ]
}
</pre><a href="#section-5.2-11" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="validation-of-nativecallbackuri">
<section id="section-5.3">
        <h3 id="name-validation-of-native_callba">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-validation-of-native_callba" class="section-name selfRef">Validation of native_callback_uri</a>
        </h3>
<p id="section-5.3-1">Validation of <strong>native_callback_uri</strong> by <em>User-Interacting Authorization Server</em> and its App is <span class="bcp14">RECOMMENDED</span>, to mitiagte open redirection attacks.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">A validating Authorization Server <span class="bcp14">MAY</span> use various mechanisms outside the scope of this document.
For example, validation using <span>[<a href="#OpenID.Federation" class="cite xref">OpenID.Federation</a>]</span> is possible:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-3.1">
            <p id="section-5.3-3.1.1">Strip url path from <strong>native_callback_uri</strong> (retaining the DNS domain).<a href="#section-5.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-3.2">
            <p id="section-5.3-3.2.1">Add the url path /.well-known/openid-federation and perform trust chain resolution.<a href="#section-5.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-3.3">
            <p id="section-5.3-3.3.1">Inspect Client's metadata for redirect_uri's and validate <strong>native_callback_uri</strong> is included.<a href="#section-5.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="protocol-flow">
<section id="section-5.4">
        <h3 id="name-protocol-flow">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol Flow</a>
        </h3>
<div id="client-app-calls-initial-authorization-server">
<section id="section-5.4.1">
          <h4 id="name-client-app-calls-initial-au">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-client-app-calls-initial-au" class="section-name selfRef">Client App calls Initial Authorization Server</a>
          </h4>
<p id="section-5.4.1-1">Client App calls Initial Authorization Server's authorization_endpoint to initiate an authorization code flow and indicates App2App flow using the scope: <strong>app2app</strong>.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initial-authorization-server-returns-authorization-request-to-downstream-authorization-server">
<section id="section-5.4.2">
          <h4 id="name-initial-authorization-serve">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-initial-authorization-serve" class="section-name selfRef">Initial Authorization Server returns authorization request to Downstream Authorization Server</a>
          </h4>
<p id="section-5.4.2-1"><em>Initial Authorization Server</em> <span class="bcp14">SHALL</span> process Client's request and return an HTTP 3xx response with a Location header containing an authorization request url towards <em>Downstream Authorization Server's</em> authorization_endpoint.
The request <span class="bcp14">SHALL</span> include Client's redirect_uri as <strong>native_callback_uri</strong> in one of the methods specified in this document.<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-app-invokes-app-of-user-interacting-authorization-server">
<section id="section-5.4.3">
          <h4 id="name-client-app-invokes-app-of-u">
<a href="#section-5.4.3" class="section-number selfRef">5.4.3. </a><a href="#name-client-app-invokes-app-of-u" class="section-name selfRef">Client App invokes app of User-Interacting Authorization Server</a>
          </h4>
<p id="section-5.4.3-1">Client App <span class="bcp14">SHALL</span> use OS mechanisms to attempt to locate an app installed on the device claiming the authorization request url.
If such app is found, <em>Client App</em> <span class="bcp14">SHALL</span> natively invoke the app claiming the url to process the authorization request. This achieves the desired native navigation across applications.
If a suitable app is not found, <em>Client App</em> <span class="bcp14">SHALL</span> use HTTP to call the authorization request url and process the response:<a href="#section-5.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.3-2.1">
              <p id="section-5.4.3-2.1.1">If the response code is HTTP 2xx, <em>Client App</em> cannot accomplish the browser-less flow and <span class="bcp14">MUST</span> fallback to using the browser. The reason is that it reached a <em>User-Interacting Authorization Server</em>, perhaps aiming to authenticate the user and authorize the request, or prompt the user for a routing decision or perhaps to redirect through HTTP Form-Post or Javascript. All of these are not compliant with the browser-less flow.<a href="#section-5.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.3-2.2">
              <p id="section-5.4.3-2.2.1">If the response is a redirect instruction (HTTP Code 3xx + Location header), <em>Client App</em> <span class="bcp14">SHALL</span> repeat the logic previously described:<a href="#section-5.4.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.3-2.2.2.1">
                  <p id="section-5.4.3-2.2.2.1.1">Check if an app claims the url in the Location header, and if so natively invoke it.<a href="#section-5.4.3-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.4.3-2.2.2.2">
                  <p id="section-5.4.3-2.2.2.2.1">Otherwise use HTTP to call the url and analyze the response.<a href="#section-5.4.3-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.4.3-2.3">
              <p id="section-5.4.3-2.3.1">Client App <span class="bcp14">SHALL</span> handle error responses (HTTP 4xx / 5xx), for example display the error.<a href="#section-5.4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.4.3-3">As the <em>Client App</em> traverses through Brokers, it <span class="bcp14">SHALL</span> maintain a list of all the DNS domains it traverses, to be used as Allowlist for response handling traversal.<a href="#section-5.4.3-3" class="pilcrow">¶</a></p>
<p id="section-5.4.3-4">As Authorization Servers <span class="bcp14">MAY</span> use Cookies to bind security elements (state, nonce, PKCE) to the user agent, causing the flow to break if said cookies are not present in subsequent HTTP requests, <em>Client App</em> <span class="bcp14">MUST</span> act as a browser would:<a href="#section-5.4.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.3-5.1">
              <p id="section-5.4.3-5.1.1">Store Cookies it obtains in HTTP responses.<a href="#section-5.4.3-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.3-5.2">
              <p id="section-5.4.3-5.2.1">Send Cookies in subsequent HTTP requests.<a href="#section-5.4.3-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="fallback-to-using-the-browser">
<section id="section-5.4.4">
          <h4 id="name-fallback-to-using-the-brows">
<a href="#section-5.4.4" class="section-number selfRef">5.4.4. </a><a href="#name-fallback-to-using-the-brows" class="section-name selfRef">Fallback to using the browser</a>
          </h4>
<p id="section-5.4.4-1">If <em>Client App</em> obtains an HTTP 2xx response, a new flow <span class="bcp14">MUST</span> be initiated <strong>using the browser</strong>. It is <span class="bcp14">NOT RECOMMENDED</span> to relaunch the current flow's last authorization request on the browser as:<a href="#section-5.4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.4-2.1">
              <p id="section-5.4.4-2.1.1">Single-use elements such as <em>request_uri</em> might have been used in the request, and if so relaunching the request on the browser will fail.<a href="#section-5.4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.4-2.2">
              <p id="section-5.4.4-2.2.1">Authorization Servers previously engaged may have returned cookies to <em>Client App</em>, which would be unavailable to the browser and cause the flow to fail.<a href="#section-5.4.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.4.4-3">Therefore <em>Client App</em> <span class="bcp14">MUST</span> start a new flow by launching on the browser a new authorization request without the <strong>app2app</strong> scope, which then follows "OAuth 2.0 for Native Apps" <span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span> and does not require further elaboration in this document.<a href="#section-5.4.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4.4-4">Note - In future interactions <em>Client App</em> <span class="bcp14">MAY</span> retry the <em>browser-less App2App</em> flow because past usage of the browser might have resulted from lack of <em>User-Interacting App</em> on the user's device.
Since in the meantime the app may have been installed, retrying may achieve the desired <em>browser-less App2App</em> flow.<a href="#section-5.4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-by-user-interacting-authorization-servers-app">
<section id="section-5.4.5">
          <h4 id="name-processing-by-user-interact">
<a href="#section-5.4.5" class="section-number selfRef">5.4.5. </a><a href="#name-processing-by-user-interact" class="section-name selfRef">Processing by User-Interacting Authorization Server's App:</a>
          </h4>
<p id="section-5.4.5-1">The <em>User-Interacting Authorization Server</em> <span class="bcp14">SHALL</span> handle the authorization request using its native app:<a href="#section-5.4.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.5-2.1">
              <p id="section-5.4.5-2.1.1">Authenticates end-user and authorizes the request.<a href="#section-5.4.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.5-2.2">
              <p id="section-5.4.5-2.2.1"><span class="bcp14">SHALL</span> use <strong>native_callback_uri</strong> to override the request's original redirect_uri:<a href="#section-5.4.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.5-2.2.2.1">
                  <p id="section-5.4.5-2.2.2.1.1"><em>User-Interacting Authorization Server's app</em> validates that an app claiming <strong>native_callback_uri</strong> is on the device<a href="#section-5.4.5-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.4.5-2.2.2.2">
                  <p id="section-5.4.5-2.2.2.2.1">If so it natively invokes <strong>native_callback_uri</strong> with the redirect url and its response parameters as the url-encoded query parameter <strong>redirect_uri</strong>.<a href="#section-5.4.5-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.4.5-2.2.2.3">
                  <p id="section-5.4.5-2.2.2.3.1">If such an app does not exist on the device, the flow terminates and <em>User-Interacting Authorization Server's app</em> redirects to redirect_uri with:<a href="#section-5.4.5-2.2.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.5-2.2.2.3.2.1">
                      <p id="section-5.4.5-2.2.2.3.2.1.1">error=invalid_request.<a href="#section-5.4.5-2.2.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.4.5-2.2.2.3.2.2">
                      <p id="section-5.4.5-2.2.2.3.2.2.1">error_description=<strong>native_callback_uri_not_claimed</strong>.<a href="#section-5.4.5-2.2.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="client-app-traverses-oauth-brokers-in-reverse-order">
<section id="section-5.4.6">
          <h4 id="name-client-app-traverses-oauth-">
<a href="#section-5.4.6" class="section-number selfRef">5.4.6. </a><a href="#name-client-app-traverses-oauth-" class="section-name selfRef">Client App traverses OAuth Brokers in reverse order</a>
          </h4>
<p id="section-5.4.6-1"><em>Client App</em> is natively invoked by <em>User-Interacting Authorization Server App</em>, with the request's redirect_uri.<a href="#section-5.4.6-1" class="pilcrow">¶</a></p>
<p id="section-5.4.6-2"><em>Client App</em> <span class="bcp14">MUST</span> validate this url, and any url subsequently obtained via a 3xx redirect instruction, against the Allowlist it previously generated, and <span class="bcp14">MUST</span> fail if any url is not included in the Allowlist.<a href="#section-5.4.6-2" class="pilcrow">¶</a></p>
<p id="section-5.4.6-3"><em>Client App</em> <span class="bcp14">SHALL</span> invoke the url it received using HTTP GET:<a href="#section-5.4.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.6-4.1">
              <p id="section-5.4.6-4.1.1">If the response is a redirect instruction (HTTP Code 3xx + Location header), <em>Client App</em> <span class="bcp14">SHALL</span> repeat the logic and proceed to call obtained urls until reaching its own redirect_uri (<strong>native_callback_uri</strong>).<a href="#section-5.4.6-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.6-4.2">
              <p id="section-5.4.6-4.2.1"><span class="bcp14">SHALL</span> handle any other HTTP code (2xx / 4xx / 5xx) as a failure.<a href="#section-5.4.6-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="client-app-obtains-response">
<section id="section-5.4.7">
          <h4 id="name-client-app-obtains-response">
<a href="#section-5.4.7" class="section-number selfRef">5.4.7. </a><a href="#name-client-app-obtains-response" class="section-name selfRef">Client App obtains response</a>
          </h4>
<p id="section-5.4.7-1">Once <em>Client App's</em> own redirect_uri is returned in a redirect 3xx directive, the traversal of OAuth Brokers is complete.<a href="#section-5.4.7-1" class="pilcrow">¶</a></p>
<p id="section-5.4.7-2"><em>Client App</em> <span class="bcp14">SHALL</span> proceed according to OAuth to exchange code for tokens, or handle error responses.<a href="#section-5.4.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="detecting-presence-of-native-apps-claiming-urls">
<section id="section-6">
      <h2 id="name-detecting-presence-of-nativ">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-detecting-presence-of-nativ" class="section-name selfRef">Detecting Presence of Native Apps claiming Urls</a>
      </h2>
<p id="section-6-1">Native Apps on iOS and Android <span class="bcp14">MAY</span> use OS SDK's to detect if an app owns a url.
The general method is the same - App calls an SDK to open the url as deep link and handles an exception thrown if no matching app is found.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="android">
<section id="section-6.1">
        <h3 id="name-android">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-android" class="section-name selfRef">Android</a>
        </h3>
<p id="section-6.1-1">App <span class="bcp14">SHALL</span> invoke Android <span>[<a href="#android.method.intent" class="cite xref">android.method.intent</a>]</span> method with FLAG_ACTIVITY_REQUIRE_NON_BROWSER, which throws ActivityNotFoundException if no matching app is found.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ios">
<section id="section-6.2">
        <h3 id="name-ios">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-ios" class="section-name selfRef">iOS</a>
        </h3>
<p id="section-6.2-1">App <span class="bcp14">SHALL</span> invoke iOS <span>[<a href="#iOS.method.openUrl" class="cite xref">iOS.method.openUrl</a>]</span> method with options <span>[<a href="#iOS.option.universalLinksOnly" class="cite xref">iOS.option.universalLinksOnly</a>]</span> which ensures URLs must be universal links and have an app configured to open them.
Otherwise the method returns false in completion.success.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="embedded-user-agents">
<section id="section-7.1">
        <h3 id="name-embedded-user-agents">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-embedded-user-agents" class="section-name selfRef">Embedded User Agents</a>
        </h3>
<p id="section-7.1-1"><span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span> Security Considerations advises against using <em>embedded user agents</em>. The main concern is preventing theft through keystroke recording of end-user's credentials such as usernames and passwords.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">This risk does not apply to this draft as <em>Client App</em> acts as User Agent only for the purpose of flow redirection, and does not interact with end-user's credentials in any way.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oauth-request-forgery-and-manipulation">
<section id="section-7.2">
        <h3 id="name-oauth-request-forgery-and-m">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-oauth-request-forgery-and-m" class="section-name selfRef">OAuth request forgery and manipulation</a>
        </h3>
<p id="section-7.2-1">It is <span class="bcp14">RECOMMENDED</span> that <em>Client App</em> acts as a confidential OAuth client.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secure-native-application-communication">
<section id="section-7.3">
        <h3 id="name-secure-native-application-c">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-secure-native-application-c" class="section-name selfRef">Secure Native application communication</a>
        </h3>
<p id="section-7.3-1">If <em>Client App</em> uses a Backend it is <span class="bcp14">RECOMMENDED</span> to communicate with it securely:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-2.1">
            <p id="section-7.3-2.1.1">Use TLS in up to date versions and ciphers.<a href="#section-7.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.2">
            <p id="section-7.3-2.2.1">Use DNSSEC.<a href="#section-7.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-2.3">
            <p id="section-7.3-2.3.1">Perform certificate pinning.<a href="#section-7.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="deep-link-hijacking">
<section id="section-7.4">
        <h3 id="name-deep-link-hijacking">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-deep-link-hijacking" class="section-name selfRef">Deep link hijacking</a>
        </h3>
<p id="section-7.4-1">It is <span class="bcp14">RECOMMENDED</span> that all apps in this specification shall use https-scheme deep links (Android App Links / iOS universal links). Apps <span class="bcp14">SHOULD</span> implement the most specific package identifiers mitigating deep link hijacking by malicious apps.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="open-redirection-by-client-app">
<section id="section-7.5">
        <h3 id="name-open-redirection-by-client-">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-open-redirection-by-client-" class="section-name selfRef">Open redirection by Client App</a>
        </h3>
<p id="section-7.5-1">Client App <span class="bcp14">SHALL</span> construct an Allowlist of DNS domains it traverses while processing the request, used to enforce all urls it later traverses during response processing.
This mitigates open redirection attacks as urls not in this Allowlist <span class="bcp14">SHALL</span> be rejected.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">In addition <em>Client App</em> <span class="bcp14">MUST</span> ignore any invocation for response processing which is not in the context of a request it initiated.
It is <span class="bcp14">RECOMMENDED</span> the Allowlist be managed as a single-use object, destructed after each protocol flow ends.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">It is <span class="bcp14">RECOMMENDED</span> <em>Client App</em> allows only one OAuth request processing at a time.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="open-redirection-by-user-interacting-authorization-servers-app">
<section id="section-7.6">
        <h3 id="name-open-redirection-by-user-in">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-open-redirection-by-user-in" class="section-name selfRef">Open redirection by User-Interacting Authorization Server's App</a>
        </h3>
<p id="section-7.6-1">It is <span class="bcp14">RECOMMENDED</span> that <em>User-Interacting Authorization Server's</em> App establishes trust in <strong>native_callback_uri</strong> to mitigate open redirection attacks and reject untrusted urls.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-code-theft-and-injection">
<section id="section-7.7">
        <h3 id="name-authorization-code-theft-an">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-authorization-code-theft-an" class="section-name selfRef">Authorization code theft and injection</a>
        </h3>
<p id="section-7.7-1">It is <span class="bcp14">RECOMMENDED</span> that PKCE is used and that the code_verifier is tied to the <em>Client App</em> instance, as mitigation to authorization code theft and injection attacks.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="OpenID">[OpenID]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0"</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Federation">[OpenID.Federation]</dt>
        <dd>
<span class="refAuthor">Hedberg, Ed, R.</span>, <span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">Solberg, A. A.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">De Marco, G.</span>, and <span class="refAuthor">V. Dzhuvinov</span>, <span class="refTitle">"OpenID Federation 1.0"</span>, <time datetime="2025-03" class="refDate">March 2025</time>, <span>&lt;<a href="https://openid.net/specs/openid-federation-1_0.html">https://openid.net/specs/openid-federation-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6750">https://www.rfc-editor.org/rfc/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
        <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7636">https://www.rfc-editor.org/rfc/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8252">[RFC8252]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span> and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 for Native Apps"</span>, <span class="seriesInfo">BCP 212</span>, <span class="seriesInfo">RFC 8252</span>, <span class="seriesInfo">DOI 10.17487/RFC8252</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8252">https://www.rfc-editor.org/rfc/rfc8252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9126">[RFC9126]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span class="seriesInfo">RFC 9126</span>, <span class="seriesInfo">DOI 10.17487/RFC9126</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9126">https://www.rfc-editor.org/rfc/rfc9126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9396">[RFC9396]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Richer, J.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <span class="seriesInfo">RFC 9396</span>, <span class="seriesInfo">DOI 10.17487/RFC9396</span>, <time datetime="2023-05" class="refDate">May 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9396">https://www.rfc-editor.org/rfc/rfc9396</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="android.method.intent">[android.method.intent]</dt>
        <dd>
<span class="refTitle">"Android Intent Method"</span>, <span>n.d.</span>, <span>&lt;<a href="https://developer.android.com/reference/android/content/Intent">https://developer.android.com/reference/android/content/Intent</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="App2App">[App2App]</dt>
        <dd>
<span class="refAuthor">Heenan, J.</span>, <span class="refTitle">"Guest Blog: Implementing App-to-App Authorisation in OAuth2/OpenID Connect"</span>, <time datetime="2019-10" class="refDate">October 2019</time>, <span>&lt;<a href="https://openid.net/guest-blog-implementing-app-to-app-authorisation-in-oauth2-openid-connect/">https://openid.net/guest-blog-implementing-app-to-app-authorisation-in-oauth2-openid-connect/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="iOS.method.openUrl">[iOS.method.openUrl]</dt>
        <dd>
<span class="refTitle">"iOS open(_:options:completionHandler:) Method"</span>, <span>n.d.</span>, <span>&lt;<a href="https://developer.apple.com/documentation/uikit/uiapplication/open(_:options:completionhandler:)">https://developer.apple.com/documentation/uikit/uiapplication/open(_:options:completionhandler:)</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="iOS.option.universalLinksOnly">[iOS.option.universalLinksOnly]</dt>
        <dd>
<span class="refTitle">"iOS method property universalLinksOnly"</span>, <span>n.d.</span>, <span>&lt;<a href="https://developer.apple.com/documentation/uikit/uiapplication/openexternalurloptionskey/universallinksonly">https://developer.apple.com/documentation/uikit/uiapplication/openexternalurloptionskey/universallinksonly</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Native-SSO">[OpenID.Native-SSO]</dt>
      <dd>
<span class="refAuthor">Fletcher, G.</span>, <span class="refTitle">"OpenID Connect Native SSO for Mobile Apps"</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-native-sso-1_0.html">https://openid.net/specs/openid-connect-native-sso-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank the following individuals who contributed ideas, feedback, and wording that shaped and formed the final specification: George Fletcher, Arndt Schwenkschuster, Henrik Kroll, Grese Hyseni.
As well as the attendees of the OAuth Security Workshop 2025 session in which this topic was discussed for their ideas and feedback.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-B">
      <h2 id="name-document-history">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-B-1">[[ To be removed from the final specification ]]<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">-latest<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">
          <p id="appendix-B-3.1.1">Phrased the challenge in Trust Domain terminology<a href="#appendix-B-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.2">
          <p id="appendix-B-3.2.1">Discussed interim Authorization Server interacting the end-user, which is not the User-Authenticating Authorization Server<a href="#appendix-B-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.3">
          <p id="appendix-B-3.3.1">Moved Cookies topic to Protocol Flow<a href="#appendix-B-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.4">
          <p id="appendix-B-3.4.1">Mentioned that Authorization Servers redirecting not through HTTP 3xx force the use of a browser<a href="#appendix-B-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.5">
          <p id="appendix-B-3.5.1">Discussed Embedded user agents security consideration<a href="#appendix-B-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.6">
          <p id="appendix-B-3.6.1">Starting to consider using a rich authorization details type as simpler container for native_callback_uri<a href="#appendix-B-3.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-4">-03<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-5.1">
          <p id="appendix-B-5.1.1">Defined parameters and values<a href="#appendix-B-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-5.2">
          <p id="appendix-B-5.2.1">Added error native_callback_uri_not_claimed<a href="#appendix-B-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-6">-02<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-7.1">
          <p id="appendix-B-7.1.1">Clarified wording<a href="#appendix-B-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-7.2">
          <p id="appendix-B-7.2.1">Improved figures<a href="#appendix-B-7.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-8">-01<a href="#appendix-B-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-9.1">
          <p id="appendix-B-9.1.1">Better defined terms<a href="#appendix-B-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-9.2">
          <p id="appendix-B-9.2.1">Explained deep link claiming detection on iOS and android<a href="#appendix-B-9.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-10">-00<a href="#appendix-B-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-11.1">
          <p id="appendix-B-11.1.1">initial working group version (previously draft-zehavi-oauth-app2app-browserless)<a href="#appendix-B-11.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yaron Zehavi</span></div>
<div dir="auto" class="left"><span class="org">Raiffeisen Bank International</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yaron.zehavi@rbinternational.com" class="email">yaron.zehavi@rbinternational.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
