<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 App2App Browserless Flow</title>
<meta content="Yaron Zehavi" name="author">
<meta content="Henrik Kroll" name="author">
<meta content="Grese Hyseni" name="author">
<meta content="
       This document defines a protocol enabling native apps from different app publishers, using the App2App pattern to act as OAuth Client And Authorization Server, native browserless user navigation. 
       The native experience is retained also when the Client uses any number of brokers to federate across trust networks, while retaining highest levels of security. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="native-apps" name="keyword">
<meta content="oauth" name="keyword">
<meta content="app2app" name="keyword">
<meta content="browserless" name="keyword">
<meta content="draft-zehavi-oauth2-app2app-browserless-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.10
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.0
    platformdirs 4.3.7
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-zehavi-oauth2-app2app-browserless.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Native OAuth App2App</td>
<td class="right">May 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Zehavi, et al.</td>
<td class="center">Expires 7 November 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-zehavi-oauth2-app2app-browserless-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-05-06" class="published">6 May 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-11-07">7 November 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Zehavi</div>
<div class="org">Raiffeisen Bank International</div>
</div>
<div class="author">
      <div class="author-name">H. Kroll</div>
<div class="org">Raiffeisen Bank International</div>
</div>
<div class="author">
      <div class="author-name">G. Hyseni</div>
<div class="org">Raiffeisen Bank International</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 App2App Browserless Flow</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines a protocol enabling native apps from different app publishers, using the App2App pattern to act as OAuth Client And Authorization Server, native browserless user navigation.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The native experience is retained also when the Client uses any number of brokers to federate across trust networks, while retaining highest levels of security.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://yaron-zehavi.github.io/oauth-app2app-browserless/draft-zehavi-oauth2-app2app-browserless.html">https://yaron-zehavi.github.io/oauth-app2app-browserless/draft-zehavi-oauth2-app2app-browserless.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-zehavi-oauth2-app2app-browserless/">https://datatracker.ietf.org/doc/draft-zehavi-oauth2-app2app-browserless/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/yaron-zehavi/oauth-app2app-browserless">https://github.com/yaron-zehavi/oauth-app2app-browserless</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 7 November 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-difference-from" class="internal xref">Difference from OpenID.Native-SSO</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-challenge-of-app2app-with-b" class="internal xref">Challenge of App2App with Brokers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-app2app-with-brokers-flow-d" class="internal xref">App2App with Brokers - Flow Diagram</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-oauth-broker" class="internal xref">OAuth Broker</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-app2app-with-brokers-requir" class="internal xref">App2App with brokers requires a web browser</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-impact-of-using-a-web-brows" class="internal xref">Impact of using a web browser</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-app2web" class="internal xref">App2Web</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-app2web-with-brokers-flow-d" class="internal xref">App2Web with Brokers - Flow Diagram</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-browser-less-app2app-with-b" class="internal xref">Browser-less App2App with Broker</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-flow-diagram" class="internal xref">Flow Diagram</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-components" class="internal xref">Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-client-app" class="internal xref">Client App</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-client-apps-primary-broker" class="internal xref">Client App's Primary Broker</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-downstream-authorization-se" class="internal xref">Downstream Authorization Server</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-protocol-flow" class="internal xref">Protocol flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-client-app-calls-primary-br" class="internal xref">Client App calls Primary Broker</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-primary-broker-returns-auth" class="internal xref">Primary Broker returns authorization request to Downstream Authorization Server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="auto internal xref">5.3.3</a>.  <a href="#name-client-app-traverses-broker" class="internal xref">Client App traverses Brokers with request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a href="#section-5.3.4" class="auto internal xref">5.3.4</a>.  <a href="#name-processing-by-user-interact" class="internal xref">Processing by User-Interacting Authorization Server</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.5">
                    <p id="section-toc.1-1.5.2.3.2.5.1"><a href="#section-5.3.5" class="auto internal xref">5.3.5</a>.  <a href="#name-client-app-traverses-brokers" class="internal xref">Client App traverses Brokers in reverse order</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.6">
                    <p id="section-toc.1-1.5.2.3.2.6.1"><a href="#section-5.3.6" class="auto internal xref">5.3.6</a>.  <a href="#name-client-app-obtains-response" class="internal xref">Client App obtains response</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-oauth-request-forgery-and-m" class="internal xref">OAuth request forgery and manipulation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-secure-native-application-c" class="internal xref">Secure Native application communication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-deep-link-hijacking" class="internal xref">Deep link hijacking</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-open-redirection" class="internal xref">Open redirection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-authorization-code-theft-an" class="internal xref">Authorization code theft and injection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-handling-of-cookies" class="internal xref">Handling of Cookies</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document, OAuth 2.0 App2App Browserless Flow (Native App2App), discusses applications from different issuers that act as OAuth 2.0 Client and Authorization Server, following the <span>[<a href="#App2App" class="cite xref">App2App</a>]</span> pattern, to achieve native authentication and authorization.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This specification addresses the challenge arising when a Client App reaches the User-Authenticating Authorization Server's app through one or more brokering Authorization Servers.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Since OAuth Brokers's urls are not owned by any apps as deep links, App2App flows through brokers require using a web browser, which degrades the user experience.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document presents a protocol enabling native App2App browser-less navigation, through any number of brokers, without compromising on any security property.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="difference-from-openidnative-sso">
<section id="section-1.1">
        <h3 id="name-difference-from">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-difference-from" class="section-name selfRef">Difference from <span class="cite xref">[OpenID.Native-SSO]</span></a>
        </h3>
<p id="section-1.1-1"><span>[<a href="#OpenID.Native-SSO" class="cite xref">OpenID.Native-SSO</a>]</span> also offers a native SSO flow across applications without requiring the browser. However, it is dealing with the specific sub-case when both apps are published by the same issuer and leverage this fact to share information.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">In addition to the terms defined in referenced specifications, this document uses
the following terms:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-2">
          <dt id="section-1.2-2.1">"OAuth":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">In this document, "OAuth" refers to OAuth 2.0, <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and <span>[<a href="#RFC6750" class="cite xref">RFC6750</a>]</span> as well as <span>[<a href="#OpenID" class="cite xref">OpenID</a>]</span> referring to their <strong>authorization code flow</strong>.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.2-3">For consistency and readability, it shall use OAuth terminology - <strong>Client</strong> and <strong>Authorization Server</strong>, equally interchangeable with OpenID Connect <strong>Relying Party</strong> and <strong>OpenID Provider</strong> when OpenID Connect is used.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-4">
          <dt id="section-1.2-4.1">"PKCE":</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.2">
            <p id="section-1.2-4.2.1">Proof Key for Code Exchange (PKCE) <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>, a mechanism
to prevent various attacks on OAuth authorization codes.<a href="#section-1.2-4.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="challenge-of-app2app-with-brokers">
<section id="section-3">
      <h2 id="name-challenge-of-app2app-with-b">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-challenge-of-app2app-with-b" class="section-name selfRef">Challenge of App2App with Brokers</a>
      </h2>
<div id="app2app-with-brokers-flow-diagram">
<section id="section-3.1">
        <h3 id="name-app2app-with-brokers-flow-d">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-app2app-with-brokers-flow-d" class="section-name selfRef">App2App with Brokers - Flow Diagram</a>
        </h3>
<span id="name-app2app-with-brokers-and-br"></span><div id="app2app-w-brokers-and-browser">
<figure id="figure-1">
          <div id="section-3.1-1.1">
            <div class="alignLeft art-svg artwork" id="section-3.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="352" width="696" viewBox="0 0 696 352" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <g class="text">
                  <text x="348" y="36">┌────────────────────────────────────────────────────────────────────────────────────┐</text>
                  <text x="8" y="52">│</text>
                  <text x="688" y="52">│</text>
                  <text x="8" y="68">│</text>
                  <text x="92" y="68">┌──────────────┐</text>
                  <text x="688" y="68">│</text>
                  <text x="8" y="84">│</text>
                  <text x="32" y="84">│</text>
                  <text x="152" y="84">│</text>
                  <text x="688" y="84">│</text>
                  <text x="8" y="100">│</text>
                  <text x="32" y="100">│</text>
                  <text x="152" y="100">│</text>
                  <text x="396" y="100">Mobile</text>
                  <text x="456" y="100">Browser</text>
                  <text x="688" y="100">│</text>
                  <text x="8" y="116">│</text>
                  <text x="32" y="116">│</text>
                  <text x="76" y="116">Client</text>
                  <text x="120" y="116">App</text>
                  <text x="152" y="116">│</text>
                  <text x="428" y="116">┌────────────────────────────────────────────────────────┐</text>
                  <text x="688" y="116">│</text>
                  <text x="8" y="132">│</text>
                  <text x="32" y="132">│</text>
                  <text x="152" y="132">│</text>
                  <text x="200" y="132">│</text>
                  <text x="384" y="132">┌───────┐</text>
                  <text x="656" y="132">│</text>
                  <text x="688" y="132">│</text>
                  <text x="8" y="148">│</text>
                  <text x="92" y="148">└──────────┬───┘</text>
                  <text x="200" y="148">│</text>
                  <text x="256" y="148">┌─────────┐</text>
                  <text x="388" y="148">│┌───────┐</text>
                  <text x="568" y="148">┌─────────────────┐</text>
                  <text x="656" y="148">│</text>
                  <text x="688" y="148">│</text>
                  <text x="8" y="164">│</text>
                  <text x="168" y="164">└─────────┼─►</text>
                  <text x="256" y="164">Primary</text>
                  <text x="364" y="164">┼──────►│┌───────┐</text>
                  <text x="496" y="164">│</text>
                  <text x="560" y="164">User-</text>
                  <text x="640" y="164">│</text>
                  <text x="656" y="164">│</text>
                  <text x="688" y="164">│</text>
                  <text x="8" y="180">│</text>
                  <text x="136" y="180">Authorization</text>
                  <text x="200" y="180">│</text>
                  <text x="216" y="180">│</text>
                  <text x="252" y="180">Broker</text>
                  <text x="296" y="180">│</text>
                  <text x="404" y="180">Auth.└││─────┘├┼───────►</text>
                  <text x="564" y="180">Authenticating</text>
                  <text x="640" y="180">│</text>
                  <text x="656" y="180">│</text>
                  <text x="688" y="180">│</text>
                  <text x="8" y="196">│</text>
                  <text x="128" y="196">Request</text>
                  <text x="200" y="196">│</text>
                  <text x="256" y="196">└─────────┘</text>
                  <text x="324" y="196">Req.</text>
                  <text x="396" y="196">└│──────┘│</text>
                  <text x="464" y="196">Auth.</text>
                  <text x="496" y="196">│</text>
                  <text x="568" y="196">Authorization</text>
                  <text x="640" y="196">│</text>
                  <text x="656" y="196">│</text>
                  <text x="688" y="196">│</text>
                  <text x="8" y="212">│</text>
                  <text x="200" y="212">│</text>
                  <text x="400" y="212">└───────┘</text>
                  <text x="460" y="212">Req.</text>
                  <text x="496" y="212">│</text>
                  <text x="564" y="212">Server</text>
                  <text x="640" y="212">│</text>
                  <text x="656" y="212">│</text>
                  <text x="688" y="212">│</text>
                  <text x="8" y="228">│</text>
                  <text x="92" y="228">┌──────────────┐</text>
                  <text x="200" y="228">│</text>
                  <text x="392" y="228">Secondary</text>
                  <text x="568" y="228">└───────┬─────────┘</text>
                  <text x="656" y="228">│</text>
                  <text x="688" y="228">│</text>
                  <text x="8" y="244">│</text>
                  <text x="32" y="244">│</text>
                  <text x="152" y="244">│</text>
                  <text x="200" y="244">│</text>
                  <text x="384" y="244">Brokers</text>
                  <text x="560" y="244">│</text>
                  <text x="656" y="244">│</text>
                  <text x="688" y="244">│</text>
                  <text x="8" y="260">│</text>
                  <text x="32" y="260">│</text>
                  <text x="96" y="260">User-</text>
                  <text x="152" y="260">│</text>
                  <text x="428" y="260">└────────────────────────────────────────────┼───────────┘</text>
                  <text x="688" y="260">│</text>
                  <text x="8" y="276">│</text>
                  <text x="92" y="276">│Authenticating│</text>
                  <text x="560" y="276">│</text>
                  <text x="688" y="276">│</text>
                  <text x="8" y="292">│</text>
                  <text x="32" y="292">│</text>
                  <text x="96" y="292">App</text>
                  <text x="356" y="292">◄──────────────────────────────────────────────────┘</text>
                  <text x="688" y="292">│</text>
                  <text x="8" y="308">│</text>
                  <text x="92" y="308">└──────────────┘</text>
                  <text x="260" y="308">Deep</text>
                  <text x="300" y="308">Link</text>
                  <text x="688" y="308">│</text>
                  <text x="348" y="324">└────────────────────────────────────────────────────────────────────────────────────┘</text>
                  <text x="364" y="340">Mobile</text>
                  <text x="420" y="340">Device</text>
                </g>
              </svg><a href="#section-3.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-app2app-with-brokers-and-br" class="selfRef">App2App with brokers and browser</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="oauth-broker">
<section id="section-3.2">
        <h3 id="name-oauth-broker">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-oauth-broker" class="section-name selfRef">OAuth Broker</a>
        </h3>
<p id="section-3.2-1">A component acting as an Authorization Server for its clients, as well as an OAuth Client towards downstream Authorization Servers.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Brokers are used to facilitate a trust relationship when there is no direct relation between an OAuth Client and the Authorization Server where the end-user authenticates and authorizes.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Brokers are used in federation use cases, such as in Academia and in the business world connecting across subsidiaries or B2B relationships across corporations.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Facilitation of trust across OAuth Clients and Authorization servers not directly connected may be solved in the future with <span>[<a href="#OpenID.Federation" class="cite xref">OpenID.Federation</a>]</span>, Brokers have been long used as an established pattern to bridge trust networks.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="app2app-with-brokers-requires-a-web-browser">
<section id="section-3.3">
        <h3 id="name-app2app-with-brokers-requir">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-app2app-with-brokers-requir" class="section-name selfRef">App2App with brokers requires a web browser</a>
        </h3>
<p id="section-3.3-1">Since OAuth Brokers reside on web domains which no native app claims as Deep Links, OAuth requests to Brokers and responses to Broker's redirect_uri will be handled by a web browser.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="impact-of-using-a-web-browser">
<section id="section-3.4">
        <h3 id="name-impact-of-using-a-web-brows">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-impact-of-using-a-web-brows" class="section-name selfRef">Impact of using a web browser</a>
        </h3>
<p id="section-3.4-1">Using a web browser downgrades the user experience in several ways. The browser may be noticed by end-user as it is loading urls and redirecting to native apps.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">The browser may prompt end-user for consent before opening deep links, introducing additional friction.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">App developers have limited control as to which browser will be opened on the return redirect to the Broker, so any cookies used to bind session identifiers (nonce, state or PKCE verifier) to the user agent may be lost, causing the flow to break.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">Finally, the browser may be left after the flow ends with "orphan" browser tabs used for redirection. While these do not impact the process directly, they can be seen as clutter which degrades the overall UX's cleanliness.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="app2web">
<section id="section-4">
      <h2 id="name-app2web">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-app2web" class="section-name selfRef">App2Web</a>
      </h2>
<p id="section-4-1">Whenever the user's device has no app owning the User-Authenticating Authorization Server's urls as deep links, the flow requires the help of a browser.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">This is the case when the User-Authenticating Authorization Server offers no native app, or when such an app exists but is not installed on the end-user's device.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">This is similar to the flow described in <span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span>, and referred to in <span>[<a href="#App2App" class="cite xref">App2App</a>]</span> as <strong>App2Web</strong>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div id="app2web-with-brokers-flow-diagram">
<section id="section-4.1">
        <h3 id="name-app2web-with-brokers-flow-d">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-app2web-with-brokers-flow-d" class="section-name selfRef">App2Web with Brokers - Flow Diagram</a>
        </h3>
<span id="name-app2web-with-brokers"></span><div id="app2web-w-brokers">
<figure id="figure-2">
          <div id="section-4.1-1.1">
            <div class="alignLeft art-svg artwork" id="section-4.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="368" width="640" viewBox="0 0 640 368" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,336" fill="none" stroke="black"></path>
                <path d="M 24,64 L 24,144" fill="none" stroke="black"></path>
                <path d="M 88,144 L 88,176" fill="none" stroke="black"></path>
                <path d="M 120,64 L 120,144" fill="none" stroke="black"></path>
                <path d="M 136,112 L 136,320" fill="none" stroke="black"></path>
                <path d="M 152,144 L 152,160" fill="none" stroke="black"></path>
                <path d="M 152,192 L 152,208" fill="none" stroke="black"></path>
                <path d="M 232,144 L 232,208" fill="none" stroke="black"></path>
                <path d="M 296,144 L 296,160" fill="none" stroke="black"></path>
                <path d="M 296,192 L 296,208" fill="none" stroke="black"></path>
                <path d="M 376,144 L 376,208" fill="none" stroke="black"></path>
                <path d="M 440,144 L 440,176" fill="none" stroke="black"></path>
                <path d="M 440,208 L 440,240" fill="none" stroke="black"></path>
                <path d="M 456,240 L 456,304" fill="none" stroke="black"></path>
                <path d="M 576,240 L 576,304" fill="none" stroke="black"></path>
                <path d="M 592,144 L 592,240" fill="none" stroke="black"></path>
                <path d="M 616,112 L 616,320" fill="none" stroke="black"></path>
                <path d="M 632,32 L 632,336" fill="none" stroke="black"></path>
                <path d="M 8,32 L 632,32" fill="none" stroke="black"></path>
                <path d="M 24,64 L 120,64" fill="none" stroke="black"></path>
                <path d="M 136,112 L 616,112" fill="none" stroke="black"></path>
                <path d="M 24,144 L 80,144" fill="none" stroke="black"></path>
                <path d="M 96,144 L 120,144" fill="none" stroke="black"></path>
                <path d="M 152,144 L 232,144" fill="none" stroke="black"></path>
                <path d="M 296,144 L 376,144" fill="none" stroke="black"></path>
                <path d="M 440,144 L 592,144" fill="none" stroke="black"></path>
                <path d="M 88,176 L 128,176" fill="none" stroke="black"></path>
                <path d="M 240,176 L 296,176" fill="none" stroke="black"></path>
                <path d="M 384,192 L 440,192" fill="none" stroke="black"></path>
                <path d="M 152,208 L 232,208" fill="none" stroke="black"></path>
                <path d="M 296,208 L 376,208" fill="none" stroke="black"></path>
                <path d="M 464,240 L 568,240" fill="none" stroke="black"></path>
                <path d="M 456,304 L 576,304" fill="none" stroke="black"></path>
                <path d="M 136,320 L 616,320" fill="none" stroke="black"></path>
                <path d="M 8,336 L 632,336" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="448,192 436,186.4 436,197.6" fill="black" transform="rotate(0,440,192)"></polygon>
                <polygon class="arrowhead" points="304,176 292,170.4 292,181.6" fill="black" transform="rotate(0,296,176)"></polygon>
                <g class="text">
                  <text x="76" y="100">Client</text>
                  <text x="348" y="100">Mobile</text>
                  <text x="408" y="100">Browser</text>
                  <text x="72" y="116">App</text>
                  <text x="148" y="180">-&gt;</text>
                  <text x="192" y="180">Primary</text>
                  <text x="504" y="180">User-</text>
                  <text x="80" y="196">Authorization</text>
                  <text x="188" y="196">Broker</text>
                  <text x="264" y="196">Auth.</text>
                  <text x="508" y="196">Authenticating</text>
                  <text x="56" y="212">Request</text>
                  <text x="260" y="212">Req.</text>
                  <text x="408" y="212">Auth.</text>
                  <text x="512" y="212">Authorization</text>
                  <text x="328" y="228">Secondary</text>
                  <text x="404" y="228">Req.</text>
                  <text x="508" y="228">Server</text>
                  <text x="328" y="244">Brokers</text>
                  <text x="448" y="244">-</text>
                  <text x="584" y="244">-</text>
                  <text x="520" y="260">User-</text>
                  <text x="516" y="276">Authenticating</text>
                  <text x="504" y="292">Web</text>
                  <text x="532" y="292">UI</text>
                  <text x="316" y="356">Mobile</text>
                  <text x="372" y="356">Device</text>
                </g>
              </svg><a href="#section-4.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-app2web-with-brokers" class="selfRef">App2Web with brokers</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="browser-less-app2app-with-broker">
<section id="section-5">
      <h2 id="name-browser-less-app2app-with-b">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-browser-less-app2app-with-b" class="section-name selfRef">Browser-less App2App with Broker</a>
      </h2>
<div id="flow-diagram">
<section id="section-5.1">
        <h3 id="name-flow-diagram">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-flow-diagram" class="section-name selfRef">Flow Diagram</a>
      </h3>
</section>
</div>
<div id="components">
<section id="section-5.2">
        <h3 id="name-components">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-components" class="section-name selfRef">Components</a>
        </h3>
<div id="client-app">
<section id="section-5.2.1">
          <h4 id="name-client-app">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-client-app" class="section-name selfRef">Client App</a>
          </h4>
<p id="section-5.2.1-1">Native app acting as OAuth client of Primary Broker.
Client's redirect_uri is claimed as a deep link of Client App.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-apps-primary-broker">
<section id="section-5.2.2">
          <h4 id="name-client-apps-primary-broker">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-client-apps-primary-broker" class="section-name selfRef">Client App's Primary Broker</a>
          </h4>
<p id="section-5.2.2-1">An OAuth Broker:<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.1">
              <p id="section-5.2.2-2.1.1">Serving as Authorization Server for Client App<a href="#section-5.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-2.2">
              <p id="section-5.2.2-2.2.1">An OAuth client of one or more downstream authorization servers<a href="#section-5.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.2.2-3">The Primary Broker performs additional handling for browser-less App2App use-case, covered in <a href="#protocol-flow" class="auto internal xref">Section 5.3</a>.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="downstream-authorization-server">
<section id="section-5.2.3">
          <h4 id="name-downstream-authorization-se">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-downstream-authorization-se" class="section-name selfRef">Downstream Authorization Server</a>
          </h4>
<p id="section-5.2.3-1">An Authorization Server which may be a:<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<div id="secondary-broker">
<section id="section-5.2.3.1">
            <h5 id="name-secondary-broker">
<a href="#section-5.2.3.1" class="section-number selfRef">5.2.3.1. </a><a href="#name-secondary-broker" class="section-name selfRef">Secondary Broker</a>
            </h5>
<p id="section-5.2.3.1-1">Additional brokers may be engaged in redirecting the flow, serving upstream brokers as OAuth clients.<a href="#section-5.2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.1-2">They do not perform user authentication and authorization.<a href="#section-5.2.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user-interacting-authorization-server">
<section id="section-5.2.3.2">
            <h5 id="name-user-interacting-authorizat">
<a href="#section-5.2.3.2" class="section-number selfRef">5.2.3.2. </a><a href="#name-user-interacting-authorizat" class="section-name selfRef">User-Interacting Authorization Server</a>
            </h5>
<p id="section-5.2.3.2-1">The Authorization Server which interacts with end-user to perform authentication and authorization.<a href="#section-5.2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.2-2">May or may not offer App2App via a native app claiming it's urls as deep links. Such app may or may not be installed on end-user's device.<a href="#section-5.2.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="protocol-flow">
<section id="section-5.3">
        <h3 id="name-protocol-flow">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-protocol-flow" class="section-name selfRef">Protocol flow</a>
        </h3>
<div id="client-app-calls-primary-broker">
<section id="section-5.3.1">
          <h4 id="name-client-app-calls-primary-br">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-client-app-calls-primary-br" class="section-name selfRef">Client App calls Primary Broker</a>
          </h4>
<p id="section-5.3.1-1">Client App calls Primary Broker's authorization_endpoint to initiate an authorization code flow, indicating App2App flow by use of a dedicated scope such as app2app.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">Client App's redirect_uri is claimed as a deep link and will be referred to as <em>client_app_deep_link</em>.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="primary-broker-returns-authorization-request-to-downstream-authorization-server">
<section id="section-5.3.2">
          <h4 id="name-primary-broker-returns-auth">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-primary-broker-returns-auth" class="section-name selfRef">Primary Broker returns authorization request to Downstream Authorization Server</a>
          </h4>
<p id="section-5.3.2-1">Primary Broker validates Client's request and prepares an authorization request to Downstream Authorization Server's authorization_endpoint.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-2">Primary Broker provides <em>client_app_deep_link</em> to Downstream Authorization Server in the dedicated structured scope: app2app:<strong>client_app_deep_link</strong>.<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
<p id="section-5.3.2-3">Primary Broker responds with HTTP 302 and the authorization request url towards Downstream Authorization Server in the Location header.<a href="#section-5.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-app-traverses-brokers-with-request">
<section id="section-5.3.3">
          <h4 id="name-client-app-traverses-broker">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-client-app-traverses-broker" class="section-name selfRef">Client App traverses Brokers with request</a>
          </h4>
<p id="section-5.3.3-1">Client App uses OS mechanisms to detect if the authorization request URL it received is handled by an app installed on the device.<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3-2">If so, Client App natively invokes the app to process the authorization request, achieving from the user's perspective native navigation across applications.<a href="#section-5.3.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3.3-3">If an app handling the authorization request URL is not found, Client App natively calls the authorization request URL using HTTP GET and processes the response:<a href="#section-5.3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3-4.1">
              <p id="section-5.3.3-4.1.1">If the response is successful (HTTP Code 2xx), it is probably the User-Interacting Authorization Server. This means the Client App "over-stepped" and needs to downgrade to App2Web.<a href="#section-5.3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.3-4.2">
              <p id="section-5.3.3-4.2.1">If the response is a redirect instruction (HTTP Code 3xx + Location header), a Secondary Broker was reached and Client App repeats the logic previously described:<a href="#section-5.3.3-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3-4.2.2.1">
                  <p id="section-5.3.3-4.2.2.1.1">Check if an app owns the obtained url, and if so natively invoke it.<a href="#section-5.3.3-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.3-4.2.2.2">
                  <p id="section-5.3.3-4.2.2.2.1">Otherwise natively call the obtained url and analyze the response.<a href="#section-5.3.3-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.3.3-4.3">
              <p id="section-5.3.3-4.3.1">Handles error response (HTTP 4xx / 5xx) for example by displaying the error.<a href="#section-5.3.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.3.3-5">As the Client App traverses through Brokers, it maintains a list of all the domains it traverses, which shall serve as the Allowlist when later traversing the response.<a href="#section-5.3.3-5" class="pilcrow">¶</a></p>
<div id="secondary-brokers">
<section id="section-5.3.3.1">
            <h5 id="name-secondary-brokers">
<a href="#section-5.3.3.1" class="section-number selfRef">5.3.3.1. </a><a href="#name-secondary-brokers" class="section-name selfRef">Secondary Brokers</a>
            </h5>
<p id="section-5.3.3.1-1">Secondary Brokers engaged in the journey need to retain structured scope app2app:<strong>client_app_deep_link</strong> in downstream authorization requests they create.<a href="#section-5.3.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="note-downgrade-to-app2web">
<section id="section-5.3.3.2">
            <h5 id="name-note-downgrade-to-app2web">
<a href="#section-5.3.3.2" class="section-number selfRef">5.3.3.2. </a><a href="#name-note-downgrade-to-app2web" class="section-name selfRef">Note - Downgrade to App2Web</a>
            </h5>
<p id="section-5.3.3.2-1">If Client App reaches a User-Interacting Authorization Server with no app handling its urls, it may not be possible to relaunch the last authorization request URL on the browser as it might have included a single use request_uri which by now has been used and is therefore invalid.<a href="#section-5.3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3.2-2">In such a case the Client App needs to start over, generating a new authorization request without App2App indication.<a href="#section-5.3.3.2-2" class="pilcrow">¶</a></p>
<p id="section-5.3.3.2-3">This request is then launched on the browser.<a href="#section-5.3.3.2-3" class="pilcrow">¶</a></p>
<p id="section-5.3.3.2-4">The remaining flow follows <span>[<a href="#RFC8252" class="cite xref">RFC8252</a>]</span> and is therefore not further elaborated in this document.<a href="#section-5.3.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="processing-by-user-interacting-authorization-server">
<section id="section-5.3.4">
          <h4 id="name-processing-by-user-interact">
<a href="#section-5.3.4" class="section-number selfRef">5.3.4. </a><a href="#name-processing-by-user-interact" class="section-name selfRef">Processing by User-Interacting Authorization Server</a>
          </h4>
<p id="section-5.3.4-1">The User-Interacting Authorization Server processes the authorization request using its native app:<a href="#section-5.3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4-2.1">
              <p id="section-5.3.4-2.1.1">Native app displays the UI for user authentication and authorization.<a href="#section-5.3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.4-2.2">
              <p id="section-5.3.4-2.2.1">The <em>client_app_deep_link</em> provided in the strcutured scope, overrides the request's original redirect_uri:<a href="#section-5.3.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4-2.2.2.1">
                  <p id="section-5.3.4-2.2.2.1.1">User-Interacting Authorization Server's native app validates that an app owning <em>client_app_deep_link</em> is on the device<a href="#section-5.3.4-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.4-2.2.2.2">
                  <p id="section-5.3.4-2.2.2.2.1">If so it natively invokes it, handing it the redirect url with its response parameter<a href="#section-5.3.4-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.4-2.2.2.3">
                  <p id="section-5.3.4-2.2.2.3.1">If such an app does not exist it is an error and the flow terminates<a href="#section-5.3.4-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.3.4-2.3">
              <p id="section-5.3.4-2.3.1">To establish trust towards client_app_deep_link, User-Interacting Authorization Server shall use OpenID Federation:<a href="#section-5.3.4-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4-2.3.2.1">
                  <p id="section-5.3.4-2.3.2.1.1">Strips url path from <em>client_app_deep_link</em> (retaining the domain).<a href="#section-5.3.4-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.4-2.3.2.2">
                  <p id="section-5.3.4-2.3.2.2.1">Adds /.well-known/openid-federation and performs trust chain resolution.<a href="#section-5.3.4-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.4-2.3.2.3">
                  <p id="section-5.3.4-2.3.2.3.1">Inspects Client's metadata for redirect_uri's and validates <em>client_app_deep_link</em> is included.<a href="#section-5.3.4-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="client-app-traverses-brokers-in-reverse-order">
<section id="section-5.3.5">
          <h4 id="name-client-app-traverses-brokers">
<a href="#section-5.3.5" class="section-number selfRef">5.3.5. </a><a href="#name-client-app-traverses-brokers" class="section-name selfRef">Client App traverses Brokers in reverse order</a>
          </h4>
<p id="section-5.3.5-1">Client App is invoked by User-Interacting Authorization Server App with a url as parameter which is the request's redirect_uri.<a href="#section-5.3.5-1" class="pilcrow">¶</a></p>
<p id="section-5.3.5-2">Client App validates this url, and any url later obtained as a 3xx redirect instruction from the brokers it traverses, against the Allowlist it previously generated and fails if any url is not included in the Allowlist.<a href="#section-5.3.5-2" class="pilcrow">¶</a></p>
<p id="section-5.3.5-3">Client App invokes the url it received using HTTP GET:<a href="#section-5.3.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.5-4.1">
              <p id="section-5.3.5-4.1.1">If the response is a redirect instruction (HTTP Code 3xx + Location header), Client App repeats the logic and proceeds to call obtained urls until reaching its own redirect_uri (<em>client_app_deep_link</em>).<a href="#section-5.3.5-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.5-4.2">
              <p id="section-5.3.5-4.2.1">Otherwise (HTTP Code 2xx / 4xx / 5xx) is a failure.<a href="#section-5.3.5-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="client-app-obtains-response">
<section id="section-5.3.6">
          <h4 id="name-client-app-obtains-response">
<a href="#section-5.3.6" class="section-number selfRef">5.3.6. </a><a href="#name-client-app-obtains-response" class="section-name selfRef">Client App obtains response</a>
          </h4>
<p id="section-5.3.6-1">Once Client App's own redirect_uri is obtained in a redirect 3xx directive, Client App proceeds according to OAuth to exchange code for tokens or handle error responses.<a href="#section-5.3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="oauth-request-forgery-and-manipulation">
<section id="section-6.1">
        <h3 id="name-oauth-request-forgery-and-m">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-oauth-request-forgery-and-m" class="section-name selfRef">OAuth request forgery and manipulation</a>
        </h3>
<p id="section-6.1-1">It is recommended Client App shall be a confidential OAuth client.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secure-native-application-communication">
<section id="section-6.2">
        <h3 id="name-secure-native-application-c">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-secure-native-application-c" class="section-name selfRef">Secure Native application communication</a>
        </h3>
<p id="section-6.2-1">If Client App uses a Backend it is recommended to communicate with it securely:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">Use TLS recommended version and ciphers.<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.2">
            <p id="section-6.2-2.2.1">Use DNSSEC.<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.3">
            <p id="section-6.2-2.3.1">Perform certificate pinning.<a href="#section-6.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="deep-link-hijacking">
<section id="section-6.3">
        <h3 id="name-deep-link-hijacking">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-deep-link-hijacking" class="section-name selfRef">Deep link hijacking</a>
        </h3>
<p id="section-6.3-1">It is recommended that all apps in this specification shall protect their deep links using Android universal links / iOS App Links including the most specific package identifiers to prevent deep link hijacking by malicious apps.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="open-redirection">
<section id="section-6.4">
        <h3 id="name-open-redirection">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-open-redirection" class="section-name selfRef">Open redirection</a>
        </h3>
<p id="section-6.4-1">Client App constructs an Allowlist of domains it traverses through while processing the request, for enforcing urls it shall later traverse through during response processing.
This serves to mitigate open redirection attacks as urls outside of this Allowlist will be rejected.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">In addition Client App should ignore any invocation for response processing which is not in the context of a request it initiated.
One way to achieve this is by treating the Allowlist as a single-use object and destruct it after each protocol flow ends.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">Client App should allow only one OAuth request processing at a time.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-code-theft-and-injection">
<section id="section-6.5">
        <h3 id="name-authorization-code-theft-an">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-authorization-code-theft-an" class="section-name selfRef">Authorization code theft and injection</a>
        </h3>
<p id="section-6.5-1">It is recommended that PKCE is used and that the code_verifier is tied to the Client App instance.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handling-of-cookies">
<section id="section-6.6">
        <h3 id="name-handling-of-cookies">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-handling-of-cookies" class="section-name selfRef">Handling of Cookies</a>
        </h3>
<p id="section-6.6-1">Client App acts in this specification as a user agent compatible with a browser in respect to handling redirects.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">It can be expected that some Authorization Servers will use Cookies to bind security elements (state, nonce, PKCE) to the user agent.<a href="#section-6.6-2" class="pilcrow">¶</a></p>
<p id="section-6.6-3">To support these security measures and prevent breaking the flow, Client App should act like a browser with regards to Cookies, namely:<a href="#section-6.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.6-4.1">
            <p id="section-6.6-4.1.1">Store cookies it obtains on HTTP responses.<a href="#section-6.6-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.6-4.2">
            <p id="section-6.6-4.2.1">Send cookies on subsequent HTTP requests to servers that returned cookies.<a href="#section-6.6-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no IANA actions.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="OpenID">[OpenID]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0"</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Federation">[OpenID.Federation]</dt>
        <dd>
<span class="refAuthor">Hedberg, Ed, R.</span>, <span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">Solberg, A. A.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">De Marco, G.</span>, and <span class="refAuthor">V. Dzhuvinov</span>, <span class="refTitle">"OpenID Federation 1.0"</span>, <time datetime="2025-03" class="refDate">March 2025</time>, <span>&lt;<a href="https://openid.net/specs/openid-federation-1_0.html">https://openid.net/specs/openid-federation-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6750">https://www.rfc-editor.org/rfc/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
        <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7636">https://www.rfc-editor.org/rfc/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8252">[RFC8252]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span> and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 for Native Apps"</span>, <span class="seriesInfo">BCP 212</span>, <span class="seriesInfo">RFC 8252</span>, <span class="seriesInfo">DOI 10.17487/RFC8252</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8252">https://www.rfc-editor.org/rfc/rfc8252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9126">[RFC9126]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span class="seriesInfo">RFC 9126</span>, <span class="seriesInfo">DOI 10.17487/RFC9126</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9126">https://www.rfc-editor.org/rfc/rfc9126</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="App2App">[App2App]</dt>
        <dd>
<span class="refAuthor">Heenan, J.</span>, <span class="refTitle">"Guest Blog: Implementing App-to-App Authorisation in OAuth2/OpenID Connect"</span>, <time datetime="2019-10" class="refDate">October 2019</time>, <span>&lt;<a href="https://openid.net/guest-blog-implementing-app-to-app-authorisation-in-oauth2-openid-connect/">https://openid.net/guest-blog-implementing-app-to-app-authorisation-in-oauth2-openid-connect/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Native-SSO">[OpenID.Native-SSO]</dt>
      <dd>
<span class="refAuthor">Fletcher, G.</span>, <span class="refTitle">"OpenID Connect Native SSO for Mobile Apps"</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-native-sso-1_0.html">https://openid.net/specs/openid-connect-native-sso-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank the attendees of the OAuth Security Workshop 2025 session in which this was discussed, as well as the following individuals who contributed ideas, feedback, and wording that shaped and formed the final specification:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yaron Zehavi</span></div>
<div dir="auto" class="left"><span class="org">Raiffeisen Bank International</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yaron.zehavi@rbinternational.com" class="email">yaron.zehavi@rbinternational.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henrik Kroll</span></div>
<div dir="auto" class="left"><span class="org">Raiffeisen Bank International</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henrik.kroll@rbinternational.com" class="email">henrik.kroll@rbinternational.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Grese Hyseni</span></div>
<div dir="auto" class="left"><span class="org">Raiffeisen Bank International</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:grese.hyseni@rbinternational.com" class="email">grese.hyseni@rbinternational.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
